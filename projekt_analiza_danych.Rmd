---
title: "WpÅ‚yw spoÅ¼ycia alkoholu na funkcje poznawcze studentÃ³w uczelni wyÅ¼szych"
author: "Oskar Iwaszkiewicz, BartÅ‚omiej Duda, Kajetan Bernat, Olga Dawidowicz"
date: "`r Sys.Date()`"
output:
  html_document:
    self_contained: true
    theme:
      bootswatch: cosmo
    toc: true
    toc_float: false
    number_sections: false
    css: styles.css
    includes:
      in_header: header.html
  pdf_document:
    toc: true
  word_document:
    toc: true
---

<script>
document.addEventListener("DOMContentLoaded", function() {
    
    // 1. SPIS TREÅšCI
    var toc = document.querySelector("#TOC");
    
    // SCROLLBAR
    var innerContainer = document.createElement("div");
    innerContainer.className = "toc-inner-container";
    
    // Wszystkie elementy spisu do nowego kontenera
    while (toc.firstChild) {
        innerContainer.appendChild(toc.firstChild);
    }
    toc.appendChild(innerContainer);

    // 3. PRZYCISK MENU
    var btn = document.createElement("button");
    btn.innerHTML = "â˜°";
    btn.className = "toggle-sidebar-btn";
    document.body.appendChild(btn);

    btn.addEventListener("click", function() {
        var body = document.querySelector("body");
        toc.classList.toggle("hidden");
        body.classList.toggle("full-width");
        // Zmiana ikony przycisku
        btn.innerHTML = toc.classList.contains("hidden") ? "ğŸ¡²" : "â˜°";
    });

    // 4. OBSÅUGA STRZAÅEK
    // WewnÄ…trz .toc-inner-container
    var itemsWithChildren = document.querySelectorAll('.toc-inner-container li:has(ul)');
    
    itemsWithChildren.forEach(function(li) {
        li.classList.add('has-children');
        
        // StrzaÅ‚ka
        var arrow = document.createElement("span");
        arrow.className = "toc-arrow";
        arrow.innerHTML = "â–¼"; 
        
        // StrzaÅ‚ka przed linkiem
        li.insertBefore(arrow, li.firstChild);
        
        // ObsÅ‚uga klikniÄ™cia w strzaÅ‚kÄ™
        arrow.addEventListener("click", function(e) {
            e.stopPropagation(); // Nie uruchamiaj linku, tylko strzaÅ‚kÄ™
            li.classList.toggle('collapsed');
            
            // WyglÄ…d strzaÅ‚ki
            if (li.classList.contains('collapsed')) {
                arrow.innerHTML = "â–¶";
            } else {
                arrow.innerHTML = "â–¼";
            }
        });
    });
});
</script>

```{r pakiety, include=FALSE}
wymagane_pakiety <- c(
  "MASS",         
  "car",
  "validate",
  "broom",        
  "factoextra",
  "tidyverse",    
  "naniar",
  "VIM",
  "scales",
  "ggdist",
  "plotly",
  "knitr",
  "kableExtra",
  "flextable",
  "ggstatsplot",
  "sjPlot",
  "viridis"       
)
pakiety_do_instalacji <- wymagane_pakiety[!(wymagane_pakiety %in% installed.packages()[,"Package"])]

if(length(pakiety_do_instalacji)) {
  install.packages(pakiety_do_instalacji)
}

lapply(wymagane_pakiety, library, character.only = TRUE)    
```

---

**SÅ‚owa kluczowe:** *spoÅ¼ycie alkoholu, wyniki w nauce, analiza wielowymiarowa, segmentacja studentÃ³w, uwarunkowania ekonomiczne, statystyka opisowa.*

---

# Wprowadzenie
## Cel badania

GÅ‚Ã³wnym celem niniejszego projektu jest zbadanie wielowymiarowych zaleÅ¼noÅ›ci miÄ™dzy **spoÅ¼yciem alkoholu**, **stylem Å¼ycia**, a **wynikami w nauce** oraz **funkcjonowaniem poznawczym** studentÃ³w.

> **Problem badawczy:** Analiza wpÅ‚ywu kultury picia w Å›rodowisku akademickim na karierÄ™ edukacyjnÄ….

Analiza opiera siÄ™ na **danych ankietowych**. Aby zapewniÄ‡ rzetelnoÅ›Ä‡ wnioskowania statystycznego, dane poddano procesom **czyszczenia** oraz **imputacji**. Badane czynniki podzielono na cztery kluczowe grupy zmiennych:

* **Ekonomiczne:** stypendia, dochÃ³d, zakwaterowanie.
* **SpoÅ‚eczne:** relacje z rodzicami, aprobata rodzicÃ³w dla alkoholu.
* **Behawioralne:** czÄ™stotliwoÅ›Ä‡ imprezowania, absencja na zajÄ™ciach.
* **Demograficzne:** pÅ‚eÄ‡, wiek.

---

## Pytania badawcze

W ramach analizy postawiono nastÄ™pujÄ…ce pytania badawcze:

1. **BezpoÅ›redni wpÅ‚yw alkoholu na wyniki:** Czy istnieje istotna statystycznie, ujemna korelacja miÄ™dzy iloÅ›ciÄ… spoÅ¼ywanego alkoholu a Å›redniÄ… ocen (GPA)?
2. **Rola statusu ekonomicznego:** Czy wyÅ¼szy dochÃ³d rozporzÄ…dalny (`allowance`) stymuluje intensywniejsze Å¼ycie towarzyskie, poÅ›rednio wpÅ‚ywajÄ…c na obniÅ¼enie wynikÃ³w w nauce?
3. **Åšrodowisko zamieszkania a kultura studencka:** Czy rodzaj zakwaterowania rÃ³Å¼nicuje siÅ‚Ä™ zwiÄ…zku miÄ™dzy spoÅ¼yciem alkoholu a liczbÄ… opuszczonych zajÄ™Ä‡?
4. **PsychospoÅ‚eczne determinanty:** Czy jakoÅ›Ä‡ relacji z rodzicami oraz ich aprobata dla spoÅ¼ywania alkoholu stanowiÄ… istotne predyktory ryzykownych zachowaÅ„ studentÃ³w?
5. **Efekt kompensacji:** Czy zwiÄ™kszony nakÅ‚ad pracy wÅ‚asnej (dodatkowe godziny nauki w tygodniu) jest w stanie zniwelowaÄ‡ negatywny wpÅ‚yw "imprezowego stylu Å¼ycia" na Å›redniÄ… ocen?
6. **Ryzyko akademickie:** W jakim stopniu "imprezowy styl Å¼ycia" zwiÄ™ksza ryzyko niezdania przedmiotÃ³w?
7. **RÃ³Å¼nice miÄ™dzypÅ‚ciowe (Gender Gap):** Czy pÅ‚eÄ‡ studenta rÃ³Å¼nicuje wzorce spoÅ¼ycia alkoholu i jego wpÅ‚yw na oceny?


```{r data wrangling, include=FALSE}
dane <- read.csv("Stats survey.csv")
dane[dane == ""] <- NA
dane <- dane %>% dplyr::select(-Timestamp)
dane <- dane %>% rename(sex = Your.Sex.,
                        grade_12 = Your.Matric..grade.12..Average..GPA..in...,
                        last_year = What.year.were.you.in.last.year..2023...,
                        faculty = What.faculty.does.your.degree.fall.under.,
                        grade_last_y = Your.2023.academic.year.average.GPA.in....Ignore.if.you.are.2024.1st.year.student.,
                        accomodation = Your.Accommodation.Status.Last.Year..2023.,
                        allowance = Monthly.Allowance.in.2023,
                        scholarship = Were.you.on.scholarship.bursary.in.2023.,
                        studying = Additional.amount.of.studying..in.hrs..per.week,
                        partying = How.often.do.you.go.out.partying.socialising.during.the.week..,
                        drinks = On.a.night.out..how.many.alcoholic.drinks.do.you.consume.,
                        classes_missed =  How.many.classes.do.you.miss.per.week.due.to.alcohol.reasons...i.e..being.hungover.or.too.tired..,
                        modules_failed = How.many.modules.have.you.failed.thus.far.into.your.studies.,
                        relationship = Are.you.currently.in.a.romantic.relationship.,
                        parents_alcohol_approval = Do.your.parents.approve.alcohol.consumption.,
                        relationship_w_parents =How.strong.is.your.relationship.with.your.parent.s.)

dane$sex <- ifelse(dane$sex == "Female", 0, ifelse(dane$sex == "Male", 1, dane$sex))
dane$sex <- factor(dane$sex, levels = c(0,1), labels = c("Kobieta", "MÄ™Å¼czyzna"))
dane$last_year <- ifelse(is.na(dane$last_year) & is.na(dane$grade_last_y), "12th class", dane$last_year)
dane$last_year <- factor(dane$last_year, levels = c("12th class", "1st Year", "2nd Year", "3rd Year", "4th Year", "Postgraduate"))
dane$faculty <- factor(dane$faculty, levels = unique(dane$faculty))
dane$accomodation <- ifelse(grepl("^Private.*", dane$accomodation), 1, ifelse(grepl("^Non.*", dane$accomodation), 0, dane$accomodation))
dane$accomodation <- factor(dane$accomodation, levels = c(0,1), labels = c("Nonprivate", "Private"))
dane$allowance <- factor(dane$allowance, levels = c("R 4001- R 5000", "R 5001 - R 6000", "R 6001 - R 7000", "R 7001 - R 8000", "R 8000+"))
dane$scholarship <- ifelse(dane$scholarship == "No", 0, ifelse(grepl("^Yes.*", dane$scholarship),1,dane$scholarship))
dane$scholarship <- factor(dane$scholarship, levels = c(0,1), labels = c("No", "Yes"))
dane$studying <- factor(dane$studying, levels = c("0", "1-3", "3-5", "5-8", "8+"))
dane$partying <- factor(dane$partying, levels = c("0", "1", "Only weekends", "2", "3", "4+"))
dane$drinks <- factor(dane$drinks, levels = c("0", "1-3", "3-5", "5-8", "8+"))
dane$classes_missed <- factor(dane$classes_missed, levels = c("0", "1", "2", "3",  "4+"))
dane$modules_failed <- factor(dane$modules_failed, levels = c("0", "1", "2", "3",  "4+"))
dane$relationship <- ifelse(dane$relationship == "No", 0, ifelse(dane$relationship == "Yes", 1, dane$relationship))
dane$relationship <- factor(dane$relationship, levels = c(0,1), labels = c("No", "Yes"))
dane$parents_alcohol_approval <- ifelse(dane$parents_alcohol_approval == "No", 0, ifelse(dane$parents_alcohol_approval == "Yes", 1, dane$parents_alcohol_approval))
dane$parents_alcohol_approval <- factor(dane$parents_alcohol_approval, levels = c(0,1), 
                                        labels = c("No", "Yes"))
dane$relationship_w_parents <- factor(dane$relationship_w_parents, levels = c("Distant", "Fair", "Close", "Very close"))
```

# Czyszczenie danych

W tym etapie surowe dane ankietowe zostaÅ‚y poddane standaryzacji i transformacji, aby umoÅ¼liwiÄ‡ ich dalszÄ… analizÄ™ statystycznÄ…. Wykonano nastÄ™pujÄ…ce operacje:

* **Selekcja i nazewnictwo:** UsuniÄ™to zbÄ™dne kolumny (np. znaczniki czasowe) oraz nadano zmiennym intuicyjne nazwy (np. `sex`, `grade_12`, `drinks`), zastÄ™pujÄ…c dÅ‚ugie pytania z kwestionariusza (Tabela 1).
* **Kodyfikacja zmiennych:**
    * Zmienne binarne (np. pÅ‚eÄ‡, stypendium) przekodowano na format **0-1**.
    * Zmienne opisowe (np. przedziaÅ‚y dochodÃ³w, liczba drinkÃ³w) zamieniono na **skalÄ™ porzÄ…dkowÄ…**, co pozwoli na zachowanie hierarchii danych w modelach korelacji.
* **Logika dla pierwszego roku:** Zidentyfikowano specyficznÄ… grupÄ™ studentÃ³w pierwszego roku ("12th class"). Ich braki danych w kolumnie ocen z poprzedniego roku akademickiego (`grade_last_y`) nie sÄ… bÅ‚Ä™dem, lecz wynikajÄ… ze struktury badania (brak historii studiowania). ZostaÅ‚o to uwzglÄ™dnione w procesie imputacji.
* **Walidacja danych:** Przeprowadzono weryfikacjÄ™ reguÅ‚ logicznych (np. czy wartoÅ›ci ocen mieszczÄ… siÄ™ w przedziale 0-100%), wykorzystujÄ…c pakiet `validate`.
* **Duplikaty:** Zidentyfikowano 2 duplikaty, jednak ze wzglÄ™du na specyfikÄ™ ankiety uznano je za moÅ¼liwe zbiegi okolicznoÅ›ci (identyczne odpowiedzi rÃ³Å¼nych osÃ³b) i pozostawiono w zbiorze.

```{r diagnostyka, include=FALSE}
rules <- validator(
  Oceny_12_klasa = (grade_12 >= 0 & grade_12 <= 100) | is.na(grade_12),
  Oceny_zeszly_rok = (grade_last_y >= 0 & grade_last_y <= 100) | is.na(grade_last_y),
  Brak_oceny_12_klasa = if (last_year == "12th class") is.na(grade_last_y)
)
out <- confront(dane, rules)
summary(out)

dane %>% 
  filter(is.na(last_year))

sum(duplicated(dane))
dane %>%
  filter(duplicated(.))
dane %>% 
  filter(grade_12 == 85 & grade_last_y == 73)
dane %>% 
  filter(grade_12 == 71 & is.na(grade_last_y))

dane <- dane %>% filter(!is.na(sex))
dane <- dane %>% filter(!is.na(faculty))
dane <- dane %>% filter(!is.na(last_year))
```


```{r tabela-zmiennych, echo=FALSE}
slownik <- data.frame(
  "Nazwa_Zmiennej" = c(
    "sex", "grade_12", "last_year", "faculty", "grade_last_y", 
    "accomodation", "allowance", "scholarship", "studying", 
    "partying", "drinks", "classes_missed", "modules_failed", 
    "relationship", "parents_alcohol_approval", "relationship_w_parents"
  ),
  "Opis_Pytania" = c(
    "PÅ‚eÄ‡ respondenta",
    "Åšrednia ocen z 12 klasy (GPA)",
    "Rok studiÃ³w w roku 2023",
    "Kierunek studiÃ³w",
    "Åšrednia ocen za rok akademicki 2023",
    "Status zakwaterowania (prywatne vs publiczne)",
    "MiesiÄ™czny budÅ¼et",
    "Czy student posiadaÅ‚ stypendium",
    "Dodatkowe godziny nauki tygodniowo",
    "CzÄ™stotliwoÅ›Ä‡ wychodzenia na imprezy",
    "Liczba drinkÃ³w spoÅ¼ywanych jednej nocy",
    "Liczba zajÄ™Ä‡ opuszczonych przez alkohol",
    "Liczba niezdanych przedmiotÃ³w",
    "Czy student jest w zwiÄ…zku",
    "Czy rodzice akceptujÄ… spoÅ¼ywanie alkoholu",
    "Relacja z rodzicami"
  )
)

kable(slownik, 
      col.names = c("Nazwa zmiennej", "Opis zmiennej"),
      caption = "Tabela 1: SÅ‚ownik zmiennych") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"),
                full_width = F, 
                position = "left") %>%
  column_spec(1, bold = TRUE, color = "#2c3e50") %>% 
  column_spec(2, width = "30em") 
```

# Analiza i diagnoza brakÃ³w danych

```{r wizualizacja brakÃ³w, echo=FALSE, warning=FALSE, fig.show='hold', out.width='50%', fig.height=6}
gg_miss_upset(dane, nsets = 5, nintersects = 10)


gg_miss_var(dane, show_pct = TRUE) + 
  labs(title = "Procentowy udziaÅ‚ brakÃ³w danych w zmiennych",
       y = "% BrakujÄ…cych wartoÅ›ci",
       x = "Zmienne") +
  theme_minimal()
```

Przed przystÄ…pieniem do uzupeÅ‚niania danych, przeprowadzono wizualnÄ… inspekcjÄ™ brakujÄ…cych wartoÅ›ci przy uÅ¼yciu pakietÃ³w `naniar`. PozwoliÅ‚o to na podjÄ™cie kluczowych decyzji:

1. **Eliminacja rekordÃ³w:** UsuniÄ™to obserwacje posiadajÄ…ce braki w kluczowych zmiennych strukturalnych: `sex` (pÅ‚eÄ‡), `faculty` (wydziaÅ‚) oraz `last_year` (rok studiÃ³w). Zmienne te definiujÄ… profil studenta i sÄ… trudne do wiarygodnego odtworzenia metodami statystycznymi.
2. **Identyfikacja mechanizmu brakÃ³w:** Potwierdzono, Å¼e czÄ™Å›Ä‡ brakÃ³w ma charakter strukturalny (np. brak ocen z poprzedniego roku dla studentÃ³w pierwszego roku), co wyklucza prostÄ… imputacjÄ™ Å›redniÄ… dla caÅ‚ej populacji.

```{r imputacja danych, warning=FALSE, include=FALSE}
dane_imp <- kNN(dane, variable = c("grade_last_y", "grade_12", "accomodation", "allowance", "scholarship", "studying", "classes_missed", "modules_failed"), k = 5)

dane$grade_last_y <- as.numeric(ifelse(dane$last_year != "12th class" & is.na(dane$grade_last_y), dane_imp$grade_last_y, dane$grade_last_y))

dane <- dane %>%
  mutate(
    allowance = coalesce(allowance, dane_imp$allowance),
    scholarship = coalesce(scholarship, dane_imp$scholarship),
    accomodation = coalesce(accomodation, dane_imp$accomodation),
    grade_12 = coalesce(grade_12, dane_imp$grade_12),
    studying = coalesce(studying, dane_imp$studying),
    classes_missed = coalesce(classes_missed, dane_imp$classes_missed),
    modules_failed = coalesce(modules_failed, dane_imp$modules_failed)
  )
```

# Imputacja danych

PozostaÅ‚e braki danych (w zmiennych takich jak `allowance`, `scholarship` czy `grades`) uzupeÅ‚niono, wykorzystujÄ…c algorytm **k-Nearest Neighbors (kNN)**. Metoda ta polega na znalezieniu dla kaÅ¼dej niepeÅ‚nej obserwacji grupy najbardziej podobnych do niej studentÃ³w ("sÄ…siadÃ³w") i uzupeÅ‚nieniu braku na podstawie ich danych.

**DobÃ³r parametru $k=5$:**

Decyzja o wyborze 5 sÄ…siadÃ³w wynika z koniecznoÅ›ci zachowania rÃ³wnowagi miÄ™dzy wariancjÄ… a obciÄ…Å¼eniem estymatora:

* **Ryzyko zbyt maÅ‚ego k - Wysoka wariancja:** Przy zbyt maÅ‚ej liczbie sÄ…siadÃ³w imputacja jest niestabilna i nadmiernie wraÅ¼liwa na pojedyncze wartoÅ›ci odstajÄ…ce (szum w danych).
* **Ryzyko zbyt duÅ¼ego k - Wysokie obciÄ…Å¼enie:** Zbyt duÅ¼a liczba sÄ…siadÃ³w prowadzi do nadmiernego uÅ›redniania ("wygÅ‚adzania"), co zaciera lokalne, specyficzne struktury danych.
* **Optimum:** WartoÅ›Ä‡ $k=5$ jest bezpiecznym kompromisem, pozwalajÄ…cym na stabilnÄ… predykcjÄ™ przy zachowaniu zmiennoÅ›ci populacji.

Dla zmiennej `grade_last_y` zastosowano podejÅ›cie hybrydowe: imputacja zostaÅ‚a skorygowana logicznie dla studentÃ³w pierwszego roku, aby nie przypisywaÄ‡ im ocen z okresu, gdy jeszcze nie studiowali. Zmienne czysto osobiste (`relationship`, `parents_alcohol_approval` oraz `relationship_w_parents`) pozostawiono bez zmian ze wzglÄ™du na ryzyko bÅ‚Ä™du predykcji.


```{r wizualizacja imputacji, echo=FALSE, fig.height=6, fig.show='hold', warning=FALSE, out.width='50%'}
ggplot(dane_imp, aes(x = allowance, y = grade_12, color = allowance_imp)) +
  geom_jitter(alpha = 0.6, width = 0.2, size = 2.5) +
  scale_color_manual(values = c("skyblue3", "firebrick1"), 
                     labels = c("Oryginalne", "Imputowane")) +
  labs(title = "Weryfikacja imputacji: MiesiÄ™czny budÅ¼et",
       subtitle = "RozkÅ‚ad ocen wzglÄ™dem budÅ¼etu z zaznaczeniem wartoÅ›ci uzupeÅ‚nionych",
       x = "Kategoria budÅ¼etu",
       y = "Åšrednia ocen",
       color = "Status danych") +
  theme_minimal()

ggplot(dane_imp, aes(x = accomodation, y = grade_12, color = accomodation_imp)) +
  geom_jitter(alpha = 0.6, width = 0.15, size = 2.5) +
  scale_color_manual(values = c("skyblue3", "firebrick1"), 
                     labels = c("Oryginalne", "Imputowane")) +
  labs(title = "Weryfikacja imputacji: Zakwaterowanie",
       subtitle = "RozkÅ‚ad ocen wzglÄ™dem rodzaju zakwaterowania",
       x = "Rodzaj zakwaterowania",
       y = "Åšrednia ocen",
       color = "Status danych") +
  theme_minimal()
```

## Weryfikacja jakoÅ›ci imputacji

W celu potwierdzenia poprawnoÅ›ci dziaÅ‚ania algorytmu przeprowadzono analizÄ™ wizualnÄ… dla zmiennych o najwyÅ¼szym odsetku brakÃ³w ($>5\%$): **`allowance`** oraz **`accommodation`**.

### Metodyka weryfikacji
Zestawienie powyÅ¼szych kategorii ze zmiennÄ… **`grade_12`** pozwoliÅ‚o na ocenÄ™ jakoÅ›ci uzupeÅ‚nionych danych:

* **NaturalnoÅ›Ä‡ rozkÅ‚adu:** WartoÅ›ci uzupeÅ‚nione (oznaczone kolorem **czerwonym**) pÅ‚ynnie wpisujÄ… siÄ™ w rozkÅ‚ad danych oryginalnych.
* **Brak artefaktÃ³w:** Nie zaobserwowano nienaturalnych skupisk punktÃ³w, co potwierdza stabilnoÅ›Ä‡ struktury zbioru po imputacji.

> **Wniosek:** Proces imputacji nie wprowadziÅ‚ istotnych znieksztaÅ‚ceÅ„ do struktury danych, co pozwala na uznanie zbioru za wiarygodny i gotowy do dalszego wnioskowania statystycznego.

# Wizualizacja danych

## Segmentacja studentÃ³w: Identyfikacja wzorcÃ³w

W celu zidentyfikowania dominujÄ…cych profili w populacji studenckiej, przeprowadzono dwuetapowÄ… analizÄ™ skupieÅ„. Pierwszym krokiem byÅ‚o ustalenie optymalnej liczby grup (klastrÃ³w), na jakie naleÅ¼y podzieliÄ‡ badanych.

### Krok 1: WybÃ³r liczby grup (Metoda Åokcia)
Zastosowano metodÄ™ "Å‚okcia" (Elbow Method), ktÃ³ra bada, jak zmienia siÄ™ spÃ³jnoÅ›Ä‡ wewnÄ…trz grup wraz z ich liczbÄ…. Szukamy punktu, w ktÃ³rym przyrost jakoÅ›ci podziaÅ‚u zaczyna gwaÅ‚townie maleÄ‡.

```{r zrobienie danych do wykresu Å‚okciowego, include=FALSE}
dane_analiza <- dane %>%
  mutate(
    drinks_num_score = case_when(
      drinks == "0" ~ 0,
      drinks == "1-3" ~ 2,
      drinks == "3-5" ~ 4,
      drinks == "5-8" ~ 6.5,
      drinks == "8+" ~ 10,
      TRUE ~ NA_real_
    ),
    party_num_score = case_when(
      partying == "0" ~ 0,
      partying == "1" ~ 1,
      partying == "Only weekends" ~ 1.5,
      partying == "2" ~ 2,
      partying == "3" ~ 3,
      partying == "4+" ~ 4,
      TRUE ~ NA_real_
    ),
    study_num_score = case_when(
      studying == "0" ~ 0,
      studying == "1-3" ~ 1.5, 
      studying == "3-5" ~ 4,
      studying == "5-8" ~ 6.5,
      studying == "8+" ~ 10,
      TRUE ~ NA_real_
    ),
    allow_val = case_when(
      allowance == "R 0 - R 1000" ~ 500,
      allowance == "R 1001 - R 2000" ~ 1500,
      allowance == "R 2001 - R 3000" ~ 2500,
      allowance == "R 3001 - R 4000" ~ 3500,
      allowance == "R 4001- R 5000" ~ 4500,
      allowance == "R 5001 - R 6000" ~ 5500,
      allowance == "R 6001 - R 7000" ~ 6500,
      allowance == "R 7001 - R 8000" ~ 7500,
      allowance == "R 8001+" ~ 9000,
      TRUE ~ 0
    ),
    allow_group = ifelse(allow_val > 4000, "Wysoki budÅ¼et", "Niski budÅ¼et"),
    social_index = drinks_num_score + party_num_score,
    grade_final = ifelse(is.na(grade_last_y), grade_12, grade_last_y)
  )
```

```{r elbow_plot, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
dane_do_klastrowania <- dane_analiza %>%
  dplyr::select(drinks_num_score, party_num_score, study_num_score, grade_final) %>%
  na.omit() %>%
  scale()

fviz_nbclust(dane_do_klastrowania, kmeans, method = "wss", linecolor = "#2c3e50") + 
  geom_vline(xintercept = 3, linetype = "dashed", color = "#e74c3c", size = 1) +    
  geom_point(size = 3, color = "#2c3e50") +                                         
  labs(title = "Optymalna liczba grup (Metoda Åokcia)",
       subtitle = "Wykres sugeruje podziaÅ‚ studentÃ³w na 3 profilowane grupy (klastry)",
       x = "Liczba klastrÃ³w (k)",
       y = "ZmiennoÅ›Ä‡ wewnÄ…trz grupy (WSS)") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(size = 10)
  )
```

> **Decyzja analityczna:**
Krzywa na wykresie ulega wyraÅºnemu zaÅ‚amaniu (tworzy "Å‚okieÄ‡") przy wartoÅ›ci **k = 3**. Oznacza to, Å¼e wyodrÄ™bnienie trzech grup jest najbardziej efektywnym kompromisem miÄ™dzy precyzjÄ… podziaÅ‚u a czytelnoÅ›ciÄ… wynikÃ³w. Dalsze rozdrabnianie populacji nie przynosi istotnego wzrostu jakoÅ›ci dopasowania.

### Krok 2: Charakterystyka grup (Mapa ArchetypÃ³w)

Po ustaleniu liczby klastrÃ³w ($k=3$), zastosowano algorytm *k-means* w poÅ‚Ä…czeniu z analizÄ… gÅ‚Ã³wnych skÅ‚adowych (PCA). PozwoliÅ‚o to na rzutowanie wielowymiarowych cech studentÃ³w na pÅ‚aszczyznÄ™ 2D i wizualizacjÄ™ powstaÅ‚ych archetypÃ³w.

```{r klastrowanie, echo=FALSE}
dane_clust <- dane %>%
  mutate(
    party_num = case_when(
       partying == "0" ~ 0, partying == "1" ~ 1, partying == "Only weekends" ~ 1.5,
       partying == "2" ~ 2, partying == "3" ~ 3, partying == "4+" ~ 4, TRUE ~ 0
    ),
    drinks_num = case_when(
       drinks == "0" ~ 0, drinks == "1-3" ~ 2, drinks == "3-5" ~ 4,
       drinks == "5-8" ~ 6.5, drinks == "8+" ~ 10, TRUE ~ 0
    ),
    study_num = case_when(
       studying == "0" ~ 0, studying == "1-3" ~ 1.5, studying == "3-5" ~ 4,
       studying == "5-8" ~ 6.5, studying == "8+" ~ 10, TRUE ~ 0
    ),
    missed_num = case_when(
       classes_missed == "0" ~ 0, classes_missed == "1" ~ 1, classes_missed == "2" ~ 2,
       classes_missed == "3" ~ 3, classes_missed == "4+" ~ 4, TRUE ~ 0
    ),
    failed_num = case_when(
       modules_failed == "0" ~ 0, modules_failed == "1" ~ 1, modules_failed == "2" ~ 2,
       modules_failed == "3" ~ 3, modules_failed == "4+" ~ 4, TRUE ~ 0
    ),
    grade = ifelse(is.na(grade_last_y), grade_12, grade_last_y)
  ) %>%
  dplyr::select(study_num, party_num, drinks_num, missed_num, failed_num, grade) %>%
  na.omit()

set.seed(123) 
km <- kmeans(scale(dane_clust), centers = 3) 
pca <- prcomp(scale(dane_clust))
```

```{r wykres archetypÃ³w, echo=FALSE}
df_pca <- data.frame(pca$x[,1:2], cluster = factor(km$cluster)) %>%
  bind_cols(dane_clust) %>%
  mutate(
    Archetyp = case_when(
      cluster == 1 ~ "Imprezowicz",
      cluster == 2 ~ "PrzeciÄ™tniak",
      cluster == 3 ~ "Prymus"
    ),
    opis_dymka = paste0(
      "<b>Archetyp: </b>", Archetyp, "<br>",
      "Åšrednia ocena: ", round(grade, 1), "%<br>",
      "Nauka: ", study_num, " h/tydz<br>",
      "Imprezy (index): ", party_num, "<br>",
      "Drinki (index): ", drinks_num
    )
  )

p <- ggplot(df_pca, aes(x = PC1, y = PC2, color = Archetyp, text = opis_dymka)) +
  geom_jitter(size = 2, alpha = 0.5, width = 0.12, height = 0.12) +
  scale_color_manual(values = c("Imprezowicz" = "#e74c3c",   
                                "Prymus" = "#3498db",        
                                "PrzeciÄ™tniak" = "#2ecc71")) + 
  labs(title = "Mapa ArchetypÃ³w StudentÃ³w",
       subtitle = "Analiza PCA (Punkty lekko rozsuniÄ™te dla czytelnoÅ›ci)",
       x = "Wymiar 1 (Styl Å¼ycia)", 
       y = "Wymiar 2 (Wyniki)", 
       color = "Profil") +
  theme_minimal() +
  theme(legend.position = "bottom")

ggplotly(p, tooltip = "text")
```

**Interpretacja wykresu:**

Wykres przedstawia przestrzeÅ„ zachowaÅ„ studentÃ³w rozpiÄ™tÄ… na dwÃ³ch gÅ‚Ã³wnych wymiarach (skÅ‚adowych gÅ‚Ã³wnych):

1. **OÅ› X (Wymiar 1 - Styl Å»ycia):** Odpowiada gÅ‚Ã³wnie za intensywnoÅ›Ä‡ Å¼ycia towarzyskiego. Im dalej w prawo, tym czÄ™stsze imprezy i wyÅ¼sze spoÅ¼ycie alkoholu.
2. **OÅ› Y (Wymiar 2 - Wyniki):** Koreluje z efektywnoÅ›ciÄ… akademickÄ…. Im wyÅ¼ej, tym wyÅ¼sze oceny i wiÄ™kszy nakÅ‚ad pracy wÅ‚asnej.

**Zidentyfikowane grupy:**

* **Imprezowicz (Czerwony):** Grupa dominujÄ…ca w prawej czÄ™Å›ci wykresu. Charakteryzuje siÄ™ wysokÄ… aktywnoÅ›ciÄ… towarzyskÄ…, co czÄ™sto wiÄ…Å¼e siÄ™ z niÅ¼szymi wynikami w nauce (ujemna korelacja).
* **Prymus (Niebieski):** Skupiony w gÃ³rnej czÄ™Å›ci wykresu. Studenci ci poÅ›wiÄ™cajÄ… najwiÄ™cej czasu na naukÄ™ i osiÄ…gajÄ… najwyÅ¼sze Å›rednie (GPA), kosztem ograniczonego Å¼ycia towarzyskiego.
* **PrzeciÄ™tniak (Zielony):** Grupa Å›rodkowa, balansujÄ…ca miÄ™dzy dwiema skrajnoÅ›ciami. Stanowi ona "bufor" i reprezentuje studentÃ³w starajÄ…cych siÄ™ godziÄ‡ umiarkowane rozrywki z akceptowalnymi wynikami.

```{r zrobienie danych, include=FALSE}
dane_analiza <- dane %>%
  mutate(
    allow_val = case_when(
      allowance == "R 0 - R 1000" ~ 500,
      allowance == "R 1001 - R 2000" ~ 1500,
      allowance == "R 2001 - R 3000" ~ 2500,
      allowance == "R 3001 - R 4000" ~ 3500,
      allowance == "R 4001- R 5000" ~ 4500,
      allowance == "R 5001 - R 6000" ~ 5500,
      allowance == "R 6001 - R 7000" ~ 6500,
      allowance == "R 7001 - R 8000" ~ 7500,
      allowance == "R 8001+" ~ 9000,
      TRUE ~ 0
    ),
    allow_group = ifelse(allow_val > 4000, "Wysoki budÅ¼et", "Niski budÅ¼et"),
    party_score = case_when(
      partying == "0" ~ 0,
      partying == "1" ~ 1,
      partying == "2" ~ 2,
      partying == "3" ~ 3,
      partying == "4+" ~ 4,
      partying == "Only weekends" ~ 1.5,
      TRUE ~ 0
    ),
    
    drink_score = case_when(
      drinks == "0" ~ 0,
      drinks == "1-3" ~ 2,
      drinks == "3-5" ~ 4,
      drinks == "5-8" ~ 6,
      drinks == "8+" ~ 9,
      TRUE ~ 0
    ),
    
    social_index = party_score + drink_score,
    
    grade_final = ifelse(is.na(grade_last_y), grade_12, grade_last_y))
```

## WpÅ‚yw statusu ekonomicznego na styl Å¼ycia i wyniki

W tej sekcji poddano weryfikacji pytanie badawcze: **czy wyÅ¼szy dochÃ³d rozporzÄ…dzalny stymuluje intensywniejsze Å¼ycie towarzyskie?**

```{r pytanie 2, echo=FALSE, fig.align='center'}
ggplot(dane_analiza, aes(x = social_index, y = grade_final)) +
  geom_density_2d_filled(alpha = 0.8) +
  facet_wrap(~allow_group) + 
  
  scale_fill_viridis_d(
    option = "plasma",
    labels = c("Niska", "", "", "", "", "", "", "", "","", "Wysoka")
  ) +
  
  labs(
    title = "Koncentracja studentÃ³w: Nauka vs Zabawa",
    subtitle = "ZaleÅ¼noÅ›Ä‡ miÄ™dzy budÅ¼etem a stylem Å¼ycia.",
    x = "Indeks Towarzyski",
    y = "Wynik Akademicki (GPA %)",
    fill = "GÄ™stoÅ›Ä‡ wystÄ™powania:"
  ) +
  
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_text(face = "bold", size = 10),
    plot.margin = margin(t = 10, r = 10, b = 25, l = 10),
    panel.spacing = unit(2, "lines"),
    strip.text = element_text(face = "bold")
  ) +
  
  guides(fill = guide_legend(
    nrow = 1, 
    keywidth = unit(1.3, "cm"), 
    keyheight = unit(0.4, "cm"),
    title.position = "top", 
    title.hjust = 0.5,
    label.position = "bottom"
  ))
```

### Metodologia i wskaÅºniki
Aby umoÅ¼liwiÄ‡ obiektywne porÃ³wnanie grup, wprowadzono dwa parametry analityczne:

* **PodziaÅ‚ budÅ¼etu:** PrÃ³bÄ™ badawczÄ… podzielono na dwa segmenty wzglÄ™dem miesiÄ™cznego kieszonkowego:
    * **NiÅ¼szy budÅ¼et:** $\le 5000$ R.
    * **WyÅ¼szy budÅ¼et:** $> 5000$ R.
* **Indeks Towarzyski:** Stworzono zagregowany wskaÅºnik (skala 0â€“13 pkt), bÄ™dÄ…cy sumÄ… punktÃ³w za:
    * *CzÄ™stotliwoÅ›Ä‡ imprezowania* (`partying`): 0â€“4 pkt (w tym wartoÅ›Ä‡ 1.5 dla "Only weekends").
    * *IloÅ›Ä‡ spoÅ¼ywanego alkoholu* (`drinks`): 0â€“9 pkt.
    * WskaÅºnik ten obrazuje **caÅ‚kowitÄ… intensywnoÅ›Ä‡ stylu Å¼ycia** studenta.

### Interpretacja mapy gÄ™stoÅ›ci
Wizualizacja wykorzystuje metodÄ™ estymacji gÄ™stoÅ›ci jÄ…drowej (**2D Kernel Density**). Skala kolorystyczna wskazuje na stopieÅ„ koncentracji obserwacji w danej przestrzeni.

### Kluczowe wnioski
1.  **PieniÄ…dze jako stymulant:** W grupie z **wyÅ¼szym budÅ¼etem** â€oÅ›rodek ciÄ™Å¼koÅ›ciâ€ (Å¼Ã³Å‚ty obszar) wyraÅºnie przesuwa siÄ™ w prawÄ… stronÄ™ osi X. Potwierdza to, Å¼e wiÄ™ksze zasoby finansowe uÅ‚atwiajÄ… dostÄ™p do pÅ‚atnych rozrywek i sprzyjajÄ… **czÄ™stszej konsumpcji alkoholu**.
2.  **ZwiÄ™kszone ryzyko akademickie:** ChoÄ‡ w obu grupach najwyÅ¼sze oceny korelujÄ… z niskÄ… intensywnoÅ›ciÄ… imprezowania, grupa zasobna wykazuje znacznie wiÄ™ksze **rozproszone w stronÄ™ wysokiej intensywnoÅ›ci towarzyskiej**. Sugeruje to, Å¼e nadmiar Å›rodkÃ³w sprzyja przedkÅ‚adaniu zabawy nad obowiÄ…zki.
3.  **Dyscyplina niÅ¼szych dochodÃ³w:** Studenci z niÅ¼szym budÅ¼etem wykazujÄ… silniejszÄ… koncentracjÄ™ w obszarze **umiarkowanego Å¼ycia towarzyskiego**, co przekÅ‚ada siÄ™ na statystycznie stabilniejsze i bardziej przewidywalne wyniki w nauce.

> **Podsumowanie:** WyÅ¼szy status ekonomiczny dziaÅ‚a jako **katalizator Å¼ycia towarzyskiego**. ZwiÄ™kszajÄ…c dostÄ™pnoÅ›Ä‡ kosztownych rozrywek, staje siÄ™ on poÅ›rednim czynnikiem ryzyka dla wynikÃ³w akademickich poprzez wyraÅºnÄ… zmianÄ™ priorytetÃ³w czasowych studenta.

## Åšrodowisko zamieszkania a kultura studencka

W tej czÄ™Å›ci analizy sprawdzono, czy **rodzaj zakwaterowania** (akademik vs. mieszkanie prywatne) **moderuje zwiÄ…zek** miÄ™dzy **spoÅ¼yciem alkoholu** a **absencjÄ… na zajÄ™ciach**. 

> **Hipoteza:** Weryfikujemy, czy **â€kontrola spoÅ‚ecznaâ€** w akademikach lub **wiÄ™ksza swoboda** w mieszkaniach prywatnych wpÅ‚ywajÄ… na **dyscyplinÄ™ studentÃ³w**.

```{r pytanie 3, echo=FALSE, message=FALSE, fig.align='center'}
dane_risk <- dane %>%
  mutate(
    acc_group = case_when(
      accomodation == "Nonprivate" ~ "Akademik",
      accomodation == "Private" ~ "Mieszkanie prywatne",
      TRUE ~ NA_character_
    ),
    drinks_num = case_when(
      drinks == "0" ~ 0,
      drinks == "1-3" ~ 2,
      drinks == "3-5" ~ 4,
      drinks == "5-8" ~ 6.5,
      drinks == "8+" ~ 10,
      TRUE ~ NA_real_
    ),
    missed_num = case_when(
      classes_missed == "0" ~ 0,
      classes_missed == "1" ~ 1,
      classes_missed == "2" ~ 2,
      classes_missed == "3" ~ 3,
      classes_missed == "4+" ~ 5, 
      TRUE ~ NA_real_
    )
  ) %>%
  filter(!is.na(acc_group), !is.na(drinks_num), !is.na(missed_num)) %>%
  group_by(acc_group, drinks_num) %>%
  summarise(
    pct_risk = mean(missed_num >= 2), 
    count = n(),
    .groups = "drop"
  )

ggplot(dane_risk, aes(x = drinks_num, y = pct_risk, group = acc_group)) +
  geom_line(aes(color = acc_group), size = 1.5, alpha = 0.8) +
  geom_point(aes(color = acc_group), size = 4, fill = "white", shape = 21, stroke = 2) +
  geom_text(aes(label = percent(pct_risk, accuracy = 1), color = acc_group), 
            vjust = -1.2, fontface = "bold", size = 4) +
  facet_wrap(~acc_group) +
  scale_color_manual(values = c("Akademik" = "#e74c3c", "Mieszkanie prywatne" = "#2980b9")) +
  scale_x_continuous(breaks = c(0, 2, 4, 6.5, 10),
                     labels = c("0", "1-3", "3-5", "5-8", "8+")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1), 
                     limits = c(0, max(dane_risk$pct_risk) * 1.25)) +
  labs(
    title = "Ryzyko wysokiej absencji a spoÅ¼ycie alkoholu",
    x = "Liczba drinkÃ³w",
    y = "Odsetek studentÃ³w z wysokÄ… absencjÄ… (2+)",
    color = "Mieszkanie"
  ) +
  
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", color = "#2c3e50"),
    strip.background = element_rect(fill = "#ecf0f1", color = NA),
    strip.text = element_text(face = "bold", color = "#2c3e50"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank()
  )
```

### Interpretacja wynikÃ³w

PoniÅ¼sza wizualizacja koncentruje siÄ™ na **analizie ryzyka**. OÅ› Y pokazuje odsetek studentÃ³w, ktÃ³rzy przekroczyli "bezpieczny prÃ³g" absencji (2 lub wiÄ™cej opuszczonych zajÄ™Ä‡), w zaleÅ¼noÅ›ci od intensywnoÅ›ci Å¼ycia towarzyskiego.

* **Punkt krytyczny (Eskalacja):** Do poziomu "5-8 drinkÃ³w" obie grupy zachowujÄ… siÄ™ podobnie â€“ ryzyko wysokiej absencji oscyluje wokÃ³Å‚ 30-36%. Kluczowa rÃ³Å¼nica pojawia siÄ™ przy ekstremalnym spoÅ¼yciu ("8+").
* **Efekt akademika:** W Å›rodowisku akademika nastÄ™puje gwaÅ‚towna "eksplozja" ryzyka â€“ aÅ¼ **70%** intensywnie imprezujÄ…cych studentÃ³w zaniedbuje zajÄ™cia. Krzywa wznosi siÄ™ tu znacznie bardziej stromo niÅ¼ w przypadku mieszkaÅ„ prywatnych (gdzie wskaÅºnik ten zatrzymuje siÄ™ na **47%**).
* **Wniosek Å›rodowiskowy:** Dane sugerujÄ…, Å¼e akademik stanowi **Å›rodowisko sprzyjajÄ…ce eskalacji** zachowaÅ„ skrajnych. Prawdopodobnie "efekt domina" i obecnoÅ›Ä‡ wspÃ³Å‚lokatorÃ³w sprawiajÄ…, Å¼e po ostrych imprezach znacznie trudniej jest zmobilizowaÄ‡ siÄ™ do pÃ³jÅ›cia na uczelniÄ™ niÅ¼ w cichszym mieszkaniu prywatnym.

## Analiza efektu kompensacji

Wykres trÃ³jwymiarowy sÅ‚uÅ¼y do weryfikacji **hipotezy kompensacji**. Badamy interakcjÄ™ trzech zmiennych jednoczeÅ›nie: intensywnoÅ›ci Å¼ycia towarzyskiego (oÅ› X), nakÅ‚adu pracy wÅ‚asnej (oÅ› Y) oraz wynikÃ³w w nauce (oÅ› Z). Szukamy odpowiedzi na kluczowe pytanie: **czy dodatkowe godziny nauki sÄ… w stanie zneutralizowaÄ‡ negatywny wpÅ‚yw intensywnego imprezowania na Å›redniÄ… ocen (GPA)?**

```{r pytanie 5, echo=FALSE, warning=FALSE}
dane_3d <- dane %>%
  mutate(
    study_num = case_when(
      studying == "0" ~ 0,
      studying == "1-3" ~ 1.5,
      studying == "3-5" ~ 4,
      studying == "5-8" ~ 6.5,
      studying == "8+" ~ 10,
      TRUE ~ NA_real_
    ),
    party_num = case_when(
      partying == "0" ~ 0,
      partying == "1" ~ 1,
      partying == "Only weekends" ~ 1.5,
      partying == "2" ~ 2,
      partying == "3" ~ 3,
      partying == "4+" ~ 5,
      TRUE ~ NA_real_
    ),
    GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y)
  ) %>%
  filter(!is.na(study_num), !is.na(party_num), !is.na(GPA))

plot_ly(dane_3d, 
        x = ~party_num, 
        y = ~study_num, 
        z = ~GPA, 
        color = ~GPA, 
        colors = viridis::viridis(100), 
        type = "scatter3d", 
        mode = "markers",
        marker = list(size = 5, opacity = 0.8, line = list(color = 'white', width = 0.5)),
        text = ~paste("Student ID:", row.names(dane_3d),
                      "<br>Nauka:", study_num, "h/tydz", 
                      "<br>Imprezy (index):", party_num, 
                      "<br>Åšrednia:", GPA, "%")) %>%
  layout(
    scene = list(
      xaxis = list(title = "IntensywnoÅ›Ä‡ imprez"),
      yaxis = list(title = "Dodatkowa nauka (h)"),
      zaxis = list(title = "Wynik akademicki (%)")
    ),
    title = "TrÃ³jwymiarowy model kompensacji: Nauka, Rozrywka i Wyniki"
  )
```

### Interpretacja modelu 3D

Analiza przestrzenna pozwala na sformuÅ‚owanie nastÄ™pujÄ…cych spostrzeÅ¼eÅ„ dotyczÄ…cych strategii studentÃ³w:

* **Strefa sukcesu (Kolor Å¼Ã³Å‚ty):** NajwyÅ¼sze wyniki (szczyt osi Z) koncentrujÄ… siÄ™ w obszarze, gdzie **wysoki nakÅ‚ad nauki** spotyka siÄ™ z **niskÄ… lub umiarkowanÄ… intensywnoÅ›ciÄ… imprez**.
* **Granice kompensacji:** ChoÄ‡ zwiÄ™kszenie liczby godzin nauki (przesuniÄ™cie wzdÅ‚uÅ¼ osi Y) pozytywnie wpÅ‚ywa na wynik, **nie jest w stanie w peÅ‚ni zniwelowaÄ‡** skutkÃ³w ekstremalnego imprezowania. W rogu wykresu odpowiadajÄ…cym maksymalnej rozrywce â€“ nawet przy duÅ¼ej iloÅ›ci nauki â€“ dominujÄ… kolory ciemniejsze (niÅ¼sze oceny).
* **Wniosek analityczny:** Model sugeruje wystÄ™powanie **prawa malejÄ…cych przychodÃ³w**. Dodatkowa nauka jest skuteczna, ale przy bardzo intensywnym Å¼yciu towarzyskim jej efektywnoÅ›Ä‡ drastycznie spada â€“ prawdopodobnie ze wzglÄ™du na obniÅ¼onÄ… koncentracjÄ™ i kondycjÄ™ psychofizycznÄ…, ktÃ³rej nie da siÄ™ po prostu "zauczyÄ‡".

## RÃ³Å¼nice miÄ™dzypÅ‚ciowe

Analiza wpÅ‚ywu alkoholu na wyniki byÅ‚aby niepeÅ‚na bez uwzglÄ™dnienia **czynnikÃ³w demograficznych**. 

> PoniÅ¼szy wykres weryfikuje, czy **pÅ‚eÄ‡ studenta** rÃ³Å¼nicuje **odpornoÅ›Ä‡ na akademickie skutki** Å¼ycia towarzyskiego oraz czy **dynamika spadku ocen** jest uniwersalna dla obu grup.

```{r przygotowanie pytanie 7, echo=FALSE, warning=FALSE}
dane_plot <- dane %>%
  filter(!is.na(drinks), !is.na(grade_last_y), !is.na(sex))

srednie_df <- dane_plot %>%
  group_by(sex, drinks) %>%
  summarise(srednia_ocena = mean(grade_last_y), .groups = "drop")
```

```{r wykres pytanie 7, echo=FALSE, warning=FALSE}
my_colors <- c("Kobieta" = "#FF2D55",  
               "MÄ™Å¼czyzna" = "#007AFF") 

p <- ggplot() +
  geom_violin(data = dane_plot, 
              aes(x = drinks, y = grade_last_y, color = sex, fill = sex),
              alpha = 0.1,            
              trim = TRUE,            
              size = 0.3,             
              position = position_dodge(width = 0.7)) +
  geom_line(data = srednie_df, 
            aes(x = drinks, y = srednia_ocena, group = sex, color = sex),
            size = 1.2, 
            position = position_dodge(width = 0.7)) +
  geom_point(data = srednie_df, 
             aes(x = drinks, y = srednia_ocena, color = sex,
                 text = paste0("<b>", sex, "</b>",
                               "<br>Liczba drinkÃ³w: ", drinks,
                               "<br>Åšrednia ocena: ", round(srednia_ocena, 1))),
             size = 3.5, shape = 18, 
             position = position_dodge(width = 0.7)) +
  scale_color_manual(values = my_colors) +
  scale_fill_manual(values = my_colors) +
  scale_y_continuous(limits = c(30, 100)) + 
  labs(x = "Liczba drinkÃ³w podczas wyjÅ›cia", y = "Åšrednia ocen (GPA)") +
  theme_minimal() +
  theme(
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(), 
    legend.position = "none")

final_tech <- ggplotly(p, tooltip = "text") %>%
  layout(
    font = list(family = "Arial, sans-serif", size = 12, color = "#333333"),
    title = list(text = "<b>Czy pÅ‚eÄ‡ moderuje wpÅ‚yw alkoholu na wyniki?</b>", 
                 y = 0.96, x = 0.05, xanchor = "left", font = list(size = 18)),
    legend = list(
      orientation = "h", xanchor = "center", x = 0.5, y = -0.15,
      title = list(text = "<b>PÅ‚eÄ‡: </b>"),
      itemclick = "toggleothers",
      itemdoubleclick = "toggle"
    ),
    margin = list(t = 70, b = 80, l = 60, r = 20),
    hovermode = "closest"
  ) %>%
  config(displayModeBar = FALSE)

for (i in seq_along(final_tech$x$data)) {
  if (!grepl("markers", final_tech$x$data[[i]]$mode)) {
    final_tech$x$data[[i]]$hoverinfo <- "skip"
  }
}

final_tech
```

### Interpretacja wynikÃ³w

Wizualizacja ta jest zÅ‚oÅ¼ona, poniewaÅ¼ Å‚Ä…czy analizÄ™ Å›rednich (linie) z peÅ‚nym rozkÅ‚adem danych (wykresy skrzypcowe w tle).

* **ZbieÅ¼noÅ›Ä‡ trendÃ³w:** Obie linie trendu wykazujÄ… wyraÅºnÄ… tendencjÄ™ spadkowÄ…. Oznacza to, Å¼e niezaleÅ¼nie od pÅ‚ci, zwiÄ™kszona konsumpcja alkoholu koreluje z obniÅ¼eniem wynikÃ³w w nauce.
* **Analiza dystrybucji (Skrzypce):** TÅ‚o wykresu pokazuje, Å¼e w grupach o wysokim spoÅ¼yciu (`5-8` oraz `8+`) rozrzut wynikÃ³w jest znacznie wiÄ™kszy. Oznacza to, Å¼e choÄ‡ Å›rednia spada, zdarzajÄ… siÄ™ jednostki (wÄ…skie "szczyty" skrzypiec), ktÃ³re mimo imprezowania utrzymujÄ… wysokie oceny â€“ jednak jest to margines bÅ‚Ä™du statystycznego.
* **Wniosek koÅ„cowy:** PÅ‚eÄ‡ **nie jest silnym moderatorem** tej zaleÅ¼noÅ›ci. Krzywe dla kobiet i mÄ™Å¼czyzn przebiegajÄ… niemal rÃ³wnolegle, co sugeruje, Å¼e mechanizm negatywnego wpÅ‚ywu alkoholu na zdolnoÅ›ci kognitywne jest uniwersalny i niezaleÅ¼ny od pÅ‚ci biologicznej.

# Analiza opisowa

## Statystyki opisowe wynikÃ³w akademickich (GPA)
```{r analiza opisowa rozklad ocen, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
dane_desc <- dane %>%
  mutate(GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y))

stats_gpa <- dane_desc %>%
  summarise(
    N = n(),
    Åšrednia = round(mean(GPA, na.rm = TRUE), 2),
    Mediana = median(GPA, na.rm = TRUE),
    Odchylenie = round(sd(GPA, na.rm = TRUE), 2),
    Minimum = min(GPA, na.rm = TRUE),
    Maksimum = max(GPA, na.rm = TRUE)
  )

srednia <- mean(dane_desc$GPA, na.rm = TRUE)

plot_gpa <- ggplot(dane_desc, aes(x = GPA)) +
  geom_histogram(binwidth = 5, fill = "#3498db", color = "white", alpha = 0.8) +
  geom_text(stat = "bin", binwidth = 5, 
            aes(label = ifelse(after_stat(count) > 0, after_stat(count), "")), 
            vjust = -0.5, size = 3) +
  geom_vline(xintercept = srednia, linetype = "dashed", color = "red", size = 1) +
  annotate("text", x = srednia + 1, y = 60, 
           label = paste0("Åšrednia: ", round(srednia, 2)), 
           color = "red", hjust = 0, fontface = "bold") +
  labs(title = "RozkÅ‚ad ocen studentÃ³w (GPA %)", 
       subtitle = "Czerwona linia oznacza Å›redniÄ…",
       x = "Wynik (%)", y = "Liczba studentÃ³w") +
  theme_minimal()

plot_gpa
kable(stats_gpa, caption = "Statystyki opisowe wynikÃ³w akademickich (GPA)")
```

### RozkÅ‚ad wynikÃ³w akademickich (GPA)

Przeprowadzona analiza statystyczna zmiennej charakteryzujÄ…cej wyniki w nauce (GPA) na prÃ³bie $N = 398$ studentÃ³w pozwala na sformuÅ‚owanie nastÄ™pujÄ…cych wnioskÃ³w dotyczÄ…cych struktury osiÄ…gniÄ™Ä‡ akademickich badanej populacji:

**1. PrzeciÄ™tny poziom i typowy wynik**
RozkÅ‚ad ocen przypomina klasycznÄ… **krzywÄ… Gaussa (rozkÅ‚ad normalny)**, co jest sytuacjÄ… poÅ¼Ä…danÄ… w statystyce. Potwierdza to fakt, Å¼e Å›rednia ocena ($\bar{x} = 68.4\%$) jest niemal identyczna jak mediana    ($Me = 68\%$). Taka zbieÅ¼noÅ›Ä‡ oznacza, Å¼e grupa jest symetryczna, poniewaÅ¼ nie ma tu wyraÅºnej przewagi osÃ³b z wynikami bardzo niskimi ani bardzo wysokimi. NajwiÄ™cej studentÃ³w (dominanta) uzyskuje wyniki w przedziale **70â€“75%**, co wskazuje, Å¼e standardem w badanej grupie jest poziom "dobry".

**2. ZrÃ³Å¼nicowanie wynikÃ³w (Dyspersja)**
WartoÅ›Ä‡ odchylenia standardowego ($SD = 9.98$) Å›wiadczy o umiarkowanym zrÃ³Å¼nicowaniu wynikÃ³w. W praktyce oznacza to, Å¼e **wiÄ™kszoÅ›Ä‡ badanej grupy** (ok. 68% studentÃ³w) mieÅ›ci siÄ™ w przedziale wynikÃ³w od ok. **58% do 78%**. Sugeruje to, Å¼e poziom wiedzy studentÃ³w jest stosunkowo wyrÃ³wnany, choÄ‡ oczywiÅ›cie wystÄ™pujÄ… naturalne rÃ³Å¼nice indywidualne.

**3. RozpiÄ™toÅ›Ä‡ osiÄ…gniÄ™Ä‡**
Mimo koncentracji wynikÃ³w wokÃ³Å‚ Å›redniej, w grupie wystÄ™puje peÅ‚ne spektrum osiÄ…gniÄ™Ä‡ (rozstÄ™p wynosi 66 punktÃ³w procentowych). NajniÅ¼szy zanotowany wynik to **30%**, a najwyÅ¼szy **96%**. Wskazuje to na obecnoÅ›Ä‡ w badanej grupie zarÃ³wno nielicznych osÃ³b zagroÅ¼onych niezaliczeniem (widocznych na wykresie jako pojedyncze przypadki poniÅ¼ej 40%), jak i studentÃ³w wybitnych. SÄ… to jednak wyjÄ…tki na tle caÅ‚ej populacji.

> **Podsumowanie:**
Zmienna GPA posiada poÅ¼Ä…dane wÅ‚aÅ›ciwoÅ›ci statystyczne (bliskoÅ›Ä‡ rozkÅ‚adu normalnego, brak drastycznych asymetrii), co czyni jÄ… wiarygodnym wskaÅºnikiem do dalszych analiz korelacyjnych, np. w kontekÅ›cie badania wpÅ‚ywu konsumpcji alkoholu na efektywnoÅ›Ä‡ akademickÄ….

## PorÃ³wnanie wynikÃ³w kobiet i mÄ™Å¼czyzn
Zastosowanie wizualizacji typu *Raincloud Plot*  Å‚Ä…czÄ…cej estymator gÄ™stoÅ›ci jÄ…drowej, wykres pudeÅ‚kowy oraz surowe dane punktowe pozwala na wielowymiarowÄ… ocenÄ™ zaleÅ¼noÅ›ci miÄ™dzy pÅ‚ciÄ… a efektywnoÅ›ciÄ… ksztaÅ‚cenia.

```{r rozklad ocen wzgledem plci, echo=FALSE, fig.align='center'}
dane_rain <- dane %>%
  mutate(GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y)) %>%
  filter(!is.na(sex), !is.na(GPA))

ggplot(dane_rain, aes(x = sex, y = GPA, fill = sex)) +
  stat_halfeye(adjust = .5, width = .6, .width = 0, justification = -.3, point_colour = NA) +
  geom_boxplot(width = .15, outlier.shape = NA, alpha = 0.5) +
  geom_point(aes(color = sex), position = position_jitter(width = .05), size = 1, alpha = 0.4) +
  scale_fill_manual(values = c("Kobieta" = "deeppink3", "MÄ™Å¼czyzna" = "#003357")) +
  scale_color_manual(values = c("Kobieta" = "deeppink3", "MÄ™Å¼czyzna" = "#003357")) +
  labs(title = "RozkÅ‚ad ocen wzglÄ™dem pÅ‚ci",
       x = "", y = "Wynik akademicki (%)") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none")
```

### Analiza porÃ³wnawcza struktury ocen w podziale na pÅ‚eÄ‡
**1. PrzeciÄ™tny poziom wynikÃ³w (Mediana)**
Analiza Å›rodkowych wartoÅ›ci na wykresach pokazuje, Å¼e przeciÄ™tny poziom ocen jest niemal identyczny dla obu pÅ‚ci. ZarÃ³wno kobiety, jak i mÄ™Å¼czyÅºni osiÄ…gajÄ… medianÄ™ wynikÃ³w w okolicach 68%. Oznacza to, Å¼e w badanej grupie pÅ‚eÄ‡ nie determinuje tego, czy ktoÅ› uczy siÄ™ przeciÄ™tnie lepiej, czy gorzej.

**2. KsztaÅ‚t rozkÅ‚adu ocen**
Krzywe widoczne nad wykresami majÄ… bardzo zbliÅ¼ony ksztaÅ‚t dla obu grup. Wskazuje to, Å¼e struktura ocen jest analogiczna, zarÃ³wno wÅ›rÃ³d kobiet, jak i mÄ™Å¼czyzn najliczniejsze grupy studentÃ³w uzyskujÄ… podobne wyniki. Nie widaÄ‡ tutaj zjawiska, w ktÃ³rym jedna z pÅ‚ci dominowaÅ‚aby wyraÅºnie w grupie najlepszych lub najsÅ‚abszych studentÃ³w.

**3. ZrÃ³Å¼nicowanie i rozpiÄ™toÅ›Ä‡ wynikÃ³w**
Rozrzut punktÃ³w pod wykresem pokazuje, Å¼e w obu grupach wystÄ™pujÄ… bardzo zrÃ³Å¼nicowane postawy. ZarÃ³wno wÅ›rÃ³d kobiet, jak i mÄ™Å¼czyzn znajdziemy osoby z wynikami bardzo wysokimi, jak i pojedyncze przypadki wynikÃ³w skrajnie niskich (poniÅ¼ej 40%). Zakres zmiennoÅ›ci jest porÃ³wnywalny, co potwierdza, Å¼e poziom zrÃ³Å¼nicowania wiedzy jest niezaleÅ¼ny od pÅ‚ci.

> **Podsumowanie:**
Na podstawie analizy wizualnej moÅ¼na postawiÄ‡ hipotezÄ™ o braku istotnego statystycznie zwiÄ…zku miÄ™dzy pÅ‚ciÄ… a wynikami GPA w badanej prÃ³bie. Ewentualne rÃ³Å¼nice sÄ… subtelne i prawdopodobnie nie majÄ… znaczenia praktycznego.

## Profil studenta w kontekÅ›cie statusu stypendialnego
```{r stypendium funkcje, echo=FALSE, message=FALSE, warning=FALSE}
dane_tabs <- dane %>%
  mutate(
    GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y),
    Stypendium = factor(scholarship, 
                        levels = c("No", "Yes"), 
                        labels = c("NiestypendyÅ›ci", "StypendyÅ›ci"))) %>%
  dplyr::select(GPA, Stypendium, sex, studying, partying)
```

```{r stypendium obliczenia, echo=FALSE, message=FALSE, warning=FALSE}
stats_gpa <- dane_tabs %>%
  group_by(Stypendium) %>%
  summarise(m = round(mean(GPA, na.rm = TRUE), 2),
            sd = round(sd(GPA, na.rm = TRUE), 2))

get_val <- function(df, variable, value, group, type) {
  res <- df %>%
    filter(!!sym(variable) == value & Stypendium == group) %>%
    summarise(n = n()) %>%
    pull(n)
  
  total <- sum(dane_tabs$Stypendium == group)
  
  if(length(res) == 0 || res == 0) return("0")
  if(type == "n") return(as.character(res))
  if(type == "pct") return(as.character(round(res/total*100, 1)))
}

create_row <- function(name, n1, s1, n2, s2) {
  data.frame(Cecha = name, N1 = n1, S1 = s1, N2 = n2, S2 = s2, stringsAsFactors = FALSE)
}

final_df <- rbind(
  create_row("Liczba obserwacji (N)", as.character(table(dane_tabs$Stypendium)[1]), "", as.character(table(dane_tabs$Stypendium)[2]), ""),
  create_row("Åšrednia ocen (GPA)", as.character(stats_gpa$m[1]), as.character(stats_gpa$sd[1]), as.character(stats_gpa$m[2]), as.character(stats_gpa$sd[2])),
  
  create_row("PÅEÄ†", "", "", "", ""),
  create_row("  Kobieta", get_val(dane_tabs, "sex", "Kobieta", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "sex", "Kobieta", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "sex", "Kobieta", "StypendyÅ›ci", "n"), get_val(dane_tabs, "sex", "Kobieta", "StypendyÅ›ci", "pct")),
  create_row("  MÄ™Å¼czyzna", get_val(dane_tabs, "sex", "MÄ™Å¼czyzna", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "sex", "MÄ™Å¼czyzna", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "sex", "MÄ™Å¼czyzna", "StypendyÅ›ci", "n"), get_val(dane_tabs, "sex", "MÄ™Å¼czyzna", "StypendyÅ›ci", "pct")),
  
  create_row("CZAS NAUKI [h] ", "", "", "", ""),
  create_row("  0 ", get_val(dane_tabs, "studying", "0", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "0", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "studying", "0", "StypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "0", "StypendyÅ›ci", "pct")),
  create_row("  1-3 ", get_val(dane_tabs, "studying", "1-3", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "1-3", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "studying", "1-3", "StypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "1-3", "StypendyÅ›ci", "pct")),
  create_row("  3-5 ", get_val(dane_tabs, "studying", "3-5", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "3-5", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "studying", "3-5", "StypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "3-5", "StypendyÅ›ci", "pct")),
  create_row("  5-8 ", get_val(dane_tabs, "studying", "5-8", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "5-8", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "studying", "5-8", "StypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "5-8", "StypendyÅ›ci", "pct")),
  create_row("  8+ ", get_val(dane_tabs, "studying", "8+", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "8+", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "studying", "8+", "StypendyÅ›ci", "n"), get_val(dane_tabs, "studying", "8+", "StypendyÅ›ci", "pct")),
  
  create_row("IMPREZOWANIE/TYDZIEÅƒ", "", "", "", ""),
  create_row("  0 ", get_val(dane_tabs, "partying", "0", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "0", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "partying", "0", "StypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "0", "StypendyÅ›ci", "pct")),
  create_row("  1 raz", get_val(dane_tabs, "partying", "1", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "1", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "partying", "1", "StypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "1", "StypendyÅ›ci", "pct")),
  create_row("  Tylko weekendy", get_val(dane_tabs, "partying", "Only weekends", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "Only weekends", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "partying", "Only weekends", "StypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "Only weekends", "StypendyÅ›ci", "pct")),
  create_row("  2 razy", get_val(dane_tabs, "partying", "2", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "2", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "partying", "2", "StypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "2", "StypendyÅ›ci", "pct")),
  create_row("  3 razy", get_val(dane_tabs, "partying", "3", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "3", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "partying", "3", "StypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "3", "StypendyÅ›ci", "pct")),
  create_row("  4+ razy", get_val(dane_tabs, "partying", "4+", "NiestypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "4+", "NiestypendyÅ›ci", "pct"), get_val(dane_tabs, "partying", "4+", "StypendyÅ›ci", "n"), get_val(dane_tabs, "partying", "4+", "StypendyÅ›ci", "pct"))
)
```

```{r stypendium tabela, echo=FALSE, message=FALSE, warning=FALSE}
indeksy_sekcji <- which(final_df$N1 == "" & final_df$N2 == "")

ft <- flextable(final_df) %>%
  add_header_row(values = c("", "NIESTYPENDYÅšCI", "STYPENDYÅšCI"), colwidths = c(1, 2, 2)) %>%
  set_header_labels(N1="Mean / N", S1="SD / %", N2="Mean / N", S2="SD / %") %>%
  bg(part = "header", bg = "#003357") %>%
  color(part = "header", color = "white") %>%
  bold(part = "header") %>%
  bg(i = indeksy_sekcji, bg = "#38607c") %>%
  color(i = indeksy_sekcji, color = "white") %>%
  bold(i = indeksy_sekcji) %>%
  align(align = "center", part = "all") %>%
  align(j = 1, align = "left", part = "all") %>%
  bold(i = 1:2) %>%
  autofit()

ft
```

### Analiza opisowa wedÅ‚ug stypendium

**1. Charakterystyka osiÄ…gniÄ™Ä‡ akademickich (GPA)**
Dane wskazujÄ… na duÅ¼Ä… spÃ³jnoÅ›Ä‡ obu grup w zakresie wynikÃ³w nauczania. Åšrednia ocen (GPA) niestypendystÃ³w (68,48) jest niemal identyczna z wynikiem stypendystÃ³w (67,78). Sugeruje to, Å¼e w badanej populacji status stypendialny nie zaleÅ¼y wyÅ‚Ä…cznie od ocen, co moÅ¼e wskazywaÄ‡ na istotnÄ… rolÄ™ kryteriÃ³w socjalnych w procesie przyznawania wsparcia finansowego.

**2. Struktura demograficzna i reprezentacja pÅ‚ci**
Wyniki ujawniajÄ… wyraÅºnÄ… rÃ³Å¼nicÄ™ w rozkÅ‚adzie pÅ‚ci wÅ›rÃ³d osÃ³b otrzymujÄ…cych pomoc finansowÄ…. W grupie stypendystÃ³w odnotowano znacznÄ… przewagÄ™ mÄ™Å¼czyzn (60%), podczas gdy u niestypendystÃ³w podziaÅ‚ ten jest bardziej wyrÃ³wnany (53,5% vs 46,5%). Taka struktura moÅ¼e wynikaÄ‡ ze specyfiki sytuacji materialnej badanych grup lub uwarunkowaÅ„ systemowych na danym wydziale.

**3. Inwestycja czasu w samoksztaÅ‚cenie: Nauka**
StypendyÅ›ci wykazujÄ… wyÅ¼szÄ… dyscyplinÄ™ i wiÄ™kszy nakÅ‚ad pracy wÅ‚asnej. W tej grupie nikt nie zadeklarowaÅ‚ braku nauki (0% vs 5,7% u niestypendystÃ³w), a ponad 35% osÃ³b uczy siÄ™ powyÅ¼ej 8 godzin tygodniowo. Åšwiadczy to o silnej motywacji stypendystÃ³w do utrzymania dobrych wynikÃ³w i dbaÅ‚oÅ›ci o status studenta.

**4. Styl Å¼ycia i organizacja czasu: Imprezowanie**
SposÃ³b spÄ™dzania czasu wolnego przez stypendystÃ³w wskazuje na efektywne zarzÄ…dzanie czasem. Znacznie czÄ™Å›ciej wybierajÄ… oni model odpoczynku skumulowany w weekendy (35,6% vs 26,6%), co pozwala im na peÅ‚nÄ… koncentracjÄ™ na obowiÄ…zkach akademickich w ciÄ…gu tygodnia roboczego.

> **Podsumowanie:**
Profil stypendysty wyÅ‚aniajÄ…cy siÄ™ z danych to profil studenta o wysokiej dyscyplinie pracy i umiejÄ™tnoÅ›ci optymalizacji czasu wolnego. ChoÄ‡ Å›rednie oceny obu grup sÄ… porÃ³wnywalne, stypendyÅ›ci wyrÃ³Å¼niajÄ… siÄ™ wiÄ™kszym zaangaÅ¼owaniem w naukÄ™ wÅ‚asnÄ… oraz bardziej ustrukturyzowanym stylem Å¼ycia, co sprzyja stabilnoÅ›ci ich wynikÃ³w akademickich.


## Typologia zachowaÅ„ zwiÄ…zanych ze spoÅ¼yciem alkoholu
Analiza struktury spoÅ¼ycia ujawnia dominujÄ…cy "styl picia" w badanej grupie. Ilustracja obrazuje deklarowanÄ… liczbÄ™ drinkÃ³w spoÅ¼ywanych **podczas pojedynczego wyjÅ›cia towarzyskiego**. $N = 398$

```{r spoÅ¼ycie alkoholu ilustracja, echo=FALSE, warning=FALSE, message=FALSE, fig.height=3.5, out.width="100%"}
dane_piktogram <- dane %>%
  filter(!is.na(drinks)) %>%
  count(drinks) %>%
  mutate(pct = n / sum(n),
         tekst_gora = case_when(
           drinks == "0"    ~ "Abstynencja ",
           drinks == "1-3" ~ "Symboliczne 1-3",
           drinks == "3-5" ~ "Umiarkowane 3-5",
           drinks == "5-8" ~ "Wysokie 5-8",
           drinks == "8+"  ~ "Ryzykowne 8+",
           TRUE             ~ drinks
         ),
         tekst_dol = paste0("LiczebnoÅ›Ä‡: ", n, "\nUdziaÅ‚: ", scales::percent(pct, accuracy = 1))) %>%
  arrange(match(drinks, c("0", "1-3", "3-5", "5-8", "8+")))

img_0      <- image_uri("grafiki/img0.png")
img_1_3    <- image_uri("grafiki/img1_3.png")
img_3_5    <- image_uri("grafiki/img3_5.png")
img_5_8    <- image_uri("grafiki/img5_8.png")
img_8_plus <- image_uri("grafiki/img8plus.png")

lista_grafik <- c(img_0, img_1_3, img_3_5, img_5_8, img_8_plus)

images_list <- list()
annotations_list <- list()

for (i in 1:5) {
  x_pos <- (i - 1) * 0.2 + 0.1
  
  images_list[[i]] <- list(
    source = lista_grafik[i],
    xref = "paper", yref = "paper",
    x = x_pos, 
    y = 0.5,        
    sizex = 0.16,  
    sizey = 0.60,  
    xanchor = "center", yanchor = "middle",
    layer = "below"
  )
  
  header <- list(
    x = x_pos,
    y = 0.9, 
    text = paste0("<b>", dane_piktogram$tekst_gora[i], "</b>"),
    xref = "paper", yref = "paper",
    showarrow = FALSE,
    xanchor = "center",
    font = list(size = 12)
  )
  
  footer <- list(
    x = x_pos,
    y = 0.08,
    text = dane_piktogram$tekst_dol[i],
    xref = "paper", yref = "paper",
    showarrow = FALSE,
    xanchor = "center",
    font = list(size = 13) 
  )
  
  annotations_list <- c(annotations_list, list(header, footer))
}

plot_ly() %>% 
  layout(
    paper_bgcolor = "#e6f2ff", 
    plot_bgcolor = "#e6f2ff",
    
    images = images_list,
    annotations = annotations_list,
    
    xaxis = list(showgrid = F, zeroline = F, showticklabels = F, title = "", fixedrange = T),
    yaxis = list(showgrid = F, zeroline = F, showticklabels = F, title = "", range = c(0, 1), fixedrange = T),
    
    title = list(text = "Wzorce konsumpcji alkoholu", 
                 font = list(size = 25),
                 y = 0.98),
    margin = list(t = 40, b = 20, l = 0, r = 0),
    autosize = TRUE
  ) %>%
  config(staticPlot = TRUE)
```

### Wzorce konsumpcji alkoholu "IntensywnoÅ›Ä‡"
**1. Analiza struktury spoÅ¼ycia alkoholu**
Wizualizacja danych wskazuje na znaczÄ…ce zrÃ³Å¼nicowanie w postawach studentÃ³w wobec alkoholu. NajliczniejszÄ… grupÄ™ stanowiÄ… osoby o wysokim poziomie konsumpcji (5-8 jednostek), ktÃ³re obejmujÄ… 28% badanej populacji (110 osÃ³b). Sugeruje to, Å¼e dominujÄ…cym modelem w grupie badawczej jest spoÅ¼ycie o charakterze intensywnym.

**2. Skala zjawisk skrajnych: Abstynencja vs Ryzyko**
Zjawisko caÅ‚kowitej abstynencji ma charakter niszowy i dotyczy jedynie 7% respondentÃ³w (26 osÃ³b). Po przeciwnej stronie znajduje siÄ™ grupa wykazujÄ…ca ryzykowne wzorce spoÅ¼ycia (8+ jednostek), ktÃ³ra jest liczna i obejmuje aÅ¼ 22% badanych (86 osÃ³b).

**3. Charakterystyka spoÅ¼ycia umiarkowanego i symbolicznego**
Grupy deklarujÄ…ce spoÅ¼ycie symboliczne (1-3 jednostki) oraz umiarkowane (3-5 jednostek) reprezentujÄ… po 22% udziaÅ‚u w prÃ³bie (odpowiednio 89 i 87 osÃ³b). Sumarycznie blisko poÅ‚owa badanych utrzymuje siÄ™ w przedziale niskiego i Å›redniego spoÅ¼ycia, co wskazuje na wyraÅºnÄ… polaryzacjÄ™ postaw miÄ™dzy studentami zachowujÄ…cymi kontrolÄ™ nad konsumpcjÄ… a grupÄ… pijÄ…cÄ… intensywnie.

**4. Tendencje ogÃ³lne i profil grupy**
ÅÄ…czny udziaÅ‚ osÃ³b pijÄ…cych powyÅ¼ej 5 jednostek (kategorie wysoka i ryzykowna) wynosi aÅ¼ 50% caÅ‚ej populacji badawczej. Wynik ten jest istotny z punktu widzenia higieny trybu Å¼ycia i moÅ¼e korelowaÄ‡ z innymi zachowaniami zdrowotnymi oraz wynikami akademickimi, ktÃ³re byÅ‚y analizowane we wczeÅ›niejszych sekcjach raportu.

> **Podsumowanie:**
Dane przedstawione na grafice ukazujÄ… model konsumpcji o wysokim stopniu intensywnoÅ›ci. Dominacja grup o spoÅ¼yciu wysokim i ryzykownym (Å‚Ä…cznie poÅ‚owa badanych) przy marginalnym odsetku abstynentÃ³w Å›wiadczy o szerokiej akceptacji spoÅ‚ecznej dla czÄ™stego i obfitego spoÅ¼ywania alkoholu w badanej grupie studenckiej.

# Analiza korelacji

## WpÅ‚yw alkoholu na wyniki w nauce

```{r analiza korelacji pytanie 1, echo=FALSE, message=FALSE, fig.align='center'}

dane_kor <- dane %>%
  mutate(
    drinks_num = case_when(
      drinks == "0" ~ 0,
      drinks == "1-3" ~ 2,
      drinks == "3-5" ~ 4,
      drinks == "5-8" ~ 6.5,
      drinks == "8+" ~ 10,
      TRUE ~ NA_real_
    ),
    GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y),
    drinks_label = factor(drinks_num, 
                          levels = c(0, 2, 4, 6.5, 10),
                          labels = c("0 (Brak)", "1-3 (MaÅ‚o)", "3-5 (Åšrednio)", "5-8 (DuÅ¼o)", "8+ (Bardzo duÅ¼o)"))
  ) %>%
  filter(!is.na(drinks_num), !is.na(GPA))

test_kor <- cor.test(dane_kor$drinks_num, dane_kor$GPA, method = "spearman", exact = FALSE)

ggplot(dane_kor, aes(x = drinks_num, y = GPA)) +
  geom_jitter(aes(fill = drinks_num), shape = 21, color = "white", size = 3, width = 0.6, alpha = 0.7) +
  geom_boxplot(aes(group = drinks_num), fill = NA, color = "black", 
               outlier.shape = NA, width = 1.2, size = 0.7) +
  scale_fill_viridis_c(option = "plasma", name = "Liczba drinkÃ³w", direction = -1) +
  scale_x_continuous(breaks = c(0, 2, 4, 6.5, 10),
                     labels = c("0\n(Abstynenci)", "1-3\n(Okazjonalnie)", "3-5\n(Umiarkowanie)", "5-8\n(CzÄ™sto)", "8+\n(Ryzykownie)")) +
  labs(
    title = "ZwiÄ…zek miÄ™dzy deklarowanym spoÅ¼yciem a GPA",
    subtitle = paste0("Korelacja rang Spearmana: rho = ", 
                      round(test_kor$estimate, 3), " (p < 0.001)"),
    x = "",
    y = "Åšrednia ocen (GPA %)"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, color = "#2c3e50"),
    plot.subtitle = element_text(size = 11, color = "grey40"),
    axis.text.x = element_text(face = "bold", color = "#2c3e50", size = 9), 
    legend.position = "none", 
    panel.grid.minor = element_blank(), 
    panel.grid.major.x = element_blank())
```

W celu sprawdzenia zaleÅ¼noÅ›ci miÄ™dzy iloÅ›ciÄ… spoÅ¼ywanego alkoholu a Å›redniÄ… ocen (GPA), przeprowadzono analizÄ™ korelacji rangowej Spearmana.

### Wyniki analizy
* **WspÃ³Å‚czynnik korelacji ($\rho$):** `-0.086`
* **Poziom istotnoÅ›ci ($p$):** `< 0.001`

> **Interpretacja statystyczna:**
Analiza wykazaÅ‚a istotnÄ… statystycznie ($p < 0.001$), lecz bardzo sÅ‚abÄ… ujemnÄ… korelacjÄ™. 

### Wnioski
1. **PewnoÅ›Ä‡ wyniku (IstotnoÅ›Ä‡)**: Bardzo niska wartoÅ›Ä‡ $p$ (< 0.001) potwierdza, Å¼e ujemny wynik nie jest dzieÅ‚em przypadku. W badanej populacji rzeczywiÅ›cie istnieje tendencja: osoby pijÄ…ce wiÄ™cej majÄ… statystycznie niÅ¼sze oceny, jednak jest to zaleÅ¼noÅ›Ä‡ bardzo delikatna.
2. **SiÅ‚a efektu (WielkoÅ›Ä‡)**: WspÃ³Å‚czynnik $\rho = -0.086$ oznacza korelacjÄ™ Å›ladowÄ…. IloÅ›Ä‡ wypitego alkoholu wyjaÅ›nia mniej niÅ¼ 1% zmiennoÅ›ci wynikÃ³w w nauce. W praktyce oznacza to, Å¼e znajÄ…c tylko iloÅ›Ä‡ spoÅ¼ywanego przez studenta alkoholu, nie jesteÅ›my w stanie przewidzieÄ‡ jego ocen.
3. **Mechanizmy kompensacyjne**: Tak sÅ‚aby zwiÄ…zek sugeruje, Å¼e studenci skutecznie oddzielajÄ… Å¼ycie towarzyskie od nauki. Ewentualny negatywny wpÅ‚yw alkoholu jest prawdopodobnie niwelowany przez inne czynniki (np. nadrabianie zalegÅ‚oÅ›ci w dni bez imprez) lub ujawnia siÄ™ dopiero przy skrajnym spoÅ¼yciu, ktÃ³re w tej prÃ³bie stanowi mniejszoÅ›Ä‡.

> **Podsumowanie**: Hipoteza o negatywnym wpÅ‚ywie alkoholu na oceny zostaÅ‚a potwierdzona statystycznie, jednak siÅ‚a tego oddziaÅ‚ywania jest marginalna. Samo spoÅ¼ycie alkoholu nie jest gÅ‚Ã³wnym wyznacznikiem sukcesu akademickiego â€“ kluczowe wydajÄ… siÄ™ inne czynniki

# Wnioskowanie statystyczne

## PorÃ³wnanie GPA wzglÄ™dem miejsca zamieszkania

```{r wnioskowanie statystyczne akademiki vs GPA, echo=FALSE, warning=FALSE, fig.align='center'}
test_wynik <- wilcox.test(grade_last_y ~ accomodation, data = dane)

ggplot(dane, aes(x = accomodation, y = grade_last_y, fill = accomodation)) +
  geom_boxplot(alpha = 0.7) +
  labs(subtitle = paste("p-value =", round(test_wynik$p.value, 4)),
    x = "Zakwaterowanie",
    y = "GPA w roku poprzednim",
    fill = "Zakwaterowanie"
  ) +
  scale_x_discrete(
    labels = c(
      "Nonprivate" = "Nieprywatne",
      "Private" = "Prywatne"
    )
  ) +
  scale_fill_discrete(
    labels = c(
      "Nonprivate" = "Nieprywatne",
      "Private" = "Prywatne"
    )
  ) +
  theme_minimal()
```

Sprawdzamy, czy Å›rodowisko akademika sprzyja gorszemu GPA w porÃ³wnaniu do mieszkania prywatnego. ZostaÅ‚a zbadana rÃ³Å¼nica w wynikach w ostatnim roku dla studentÃ³w, ktÃ³rzy sÄ… teraz przynajmniej na 2 roku.

### Interpretacja wynikÃ³w i wnioski
* Wynik testu Wilcoxona wskazuje na **p-value = 0.6482 > 0,05**, zatem nie ma podstaw do odrzucenia hipotezy zerowej i moÅ¼na uznaÄ‡, Å¼e nie stwierdzono istotnej statystycznie rÃ³Å¼nicy w Å›rednich i medianach.
* RozkÅ‚ady wynikÃ³w sÄ… **bardzo podobne** w obu grupach; mediany GPA sÄ… zbliÅ¼one, a rozstÄ™py miÄ™dzykwartylowe sÄ… porÃ³wnywalne.
* W grupie "Private" widoczna jest pojedyncza wartoÅ›Ä‡ odstajÄ…ca (outlier), jednak nie wpÅ‚ywa ona na ogÃ³lny wniosek o braku istotnych rÃ³Å¼nic miÄ™dzy grupami.

>**Wniosek**:PodsumowujÄ…c, miejsce zamieszkania (prywatne vs. nieprywatne) **nie ma istotnego wpÅ‚ywu** na wyniki w nauce (GPA) w badanej prÃ³bie studentÃ³w.

## ZaleÅ¼noÅ›Ä‡ miÄ™dzy aprobatÄ… rodzicÃ³w wobec spoÅ¼ywania alkoholu a tygodniowym poziomem jego konsumpcji

```{r pytanie 4 wykres test chi kwadrat, echo=FALSE, warning=FALSE, fig.align='center'}
tab <- table(dane$parents_alcohol_approval, dane$drinks)
chi_test <- chisq.test(tab)

dane %>%
  filter(!is.na(parents_alcohol_approval), !is.na(drinks)) %>%
  count(parents_alcohol_approval, drinks) %>%
  group_by(parents_alcohol_approval) %>%
  mutate(procent = n / sum(n) * 100) %>%
  ggplot(aes(x = drinks, y = parents_alcohol_approval, fill = procent)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "#f7fbff", high = "#084594") +
  geom_text(aes(label = paste0(round(procent, 1), "%")), color = "black", size = 3) +
  labs(x = "Liczba drinkÃ³w", y = "Aprobata rodzicÃ³w", fill = "% w grupie") +
  theme_minimal()
```

Na powyÅ¼szej heatmapie przedstawiono zaleÅ¼noÅ›Ä‡ miÄ™dzy aprobatÄ… rodzicÃ³w a liczbÄ… spoÅ¼ywanych drinkÃ³w, wyraÅ¼onÄ… w procentach w obrÄ™bie kaÅ¼dej grupy.

### Interpretacja wynikÃ³w i wnioski
* Osoby z aprobatÄ… rodzicÃ³w **czÄ™Å›ciej** deklarujÄ… **spoÅ¼ycie alkoholu**. NajwiÄ™kszy udziaÅ‚ wystÄ™puje w grupie spoÅ¼ywajÄ…cej `5-8 drinkÃ³w` podczas wyjÅ›cia, a sam rozkÅ‚ad jest widocznie przesuniÄ™ty w stronÄ™ wiÄ™kszej konsumpcji alkoholu.
* Osoby bez aprobaty rodzicÃ³w **rzadziej** deklarujÄ… **wysokie spoÅ¼ycie alkoholu**. NajwiÄ™kszy udziaÅ‚ wystÄ™puje w grupie spoÅ¼ywajÄ…cej `1-3 drinkÃ³w` podczas wyjÅ›cia, a rozkÅ‚ad jest bardziej skoncentrowany na niskim oraz umiarkowanym spoÅ¼yciu.
* **Brak aprobaty rodzicÃ³w** wiÄ…Å¼e siÄ™ z wiÄ™kszym odsetkiem **abstynentÃ³w**. W grupie z aprobatÄ… 5,2% badanych studentÃ³w deklaruje siÄ™ jako osoby niepijÄ…ce, natomiast w grupie bez aprobaty jest to aÅ¼ 14,6%.

> **Wniosek**: Analiza wskazuje na wyraÅºne zrÃ³Å¼nicowanie wzorcÃ³w spoÅ¼ycia alkoholu w zaleÅ¼noÅ›ci od postawy rodzicÃ³w wobec picia. Studenci, ktÃ³rych rodzice aprobujÄ… spoÅ¼ywanie alkoholu, czÄ™Å›ciej deklarujÄ… wyÅ¼sze poziomy konsumpcji (`5â€“8` oraz `8+ drinkÃ³w`), podczas gdy wÅ›rÃ³d osÃ³b bez takiej aprobaty dominujÄ… zachowania umiarkowane (`1â€“3 drinki`) lub caÅ‚kowita abstynencja. Wyniki sugerujÄ…, Å¼e postawy rodzicielskie **mogÄ… odgrywaÄ‡ istotnÄ… rolÄ™** w ksztaÅ‚towaniu nawykÃ³w zwiÄ…zanych ze spoÅ¼yciem alkoholu wÅ›rÃ³d mÅ‚odych dorosÅ‚ych.

```{r test chi kwadrat, echo=FALSE}
tidy(chi_test) %>%
  mutate(
    p_value_display = cell_spec(
      scales::pvalue(p.value, accuracy = 0.001),
      bold = ifelse(p.value < 0.05, TRUE, FALSE),
      color = ifelse(p.value < 0.05, "red", "black")
    ),
    statistic = round(statistic, 2)
  ) %>%
  dplyr::select(
    `Statystyka ChiÂ²` = statistic, 
    `Stopnie swobody (df)` = parameter, 
    `WartoÅ›Ä‡ p` = p_value_display,
    `Metoda` = method
  ) %>%
  kable(
    format = "html", 
    escape = FALSE, 
    align = "c",    
    caption = "Wyniki testu niezaleÅ¼noÅ›ci Chi-kwadrat"
  ) %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2", color = "#2c3e50") %>% 
  column_spec(1, bold = TRUE)
```

W celu potwierdzenia wnioskÃ³w sformuÅ‚owanych na podstawie heatmapy przeprowadzono **test Chi-kwadrat niezaleÅ¼noÅ›ci**. 

* **Wynik testu:** Wykazano istnienie statystycznie istotnej zaleÅ¼noÅ›ci pomiÄ™dzy **aprobatÄ… rodzicÃ³w** wobec spoÅ¼ycia alkoholu a **liczbÄ… spoÅ¼ywanych drinkÃ³w** przez studentÃ³w:
    * $\chi^2(4) = 16,06$
    * $p = 0,003$

> **Interpretacja:** PoniewaÅ¼ wartoÅ›Ä‡ $p < 0,05$, odrzucamy hipotezÄ™ o niezaleÅ¼noÅ›ci zmiennych. Oznacza to, Å¼e rozkÅ‚ad spoÅ¼ycia alkoholu istotnie rÃ³Å¼ni siÄ™ w zaleÅ¼noÅ›ci od postawy rodzicÃ³w â€“ ich aprobata (lub jej brak) jest silnym predyktorem zachowaÅ„ studentÃ³w.

## Åšrednie spoÅ¼ycie alkoholu na wydziaÅ‚ach

```{r rÃ³Å¼nice miÄ™dzy wydziaÅ‚ami, echo=FALSE, fig.align='center'}
dane_fac <- dane %>%
  mutate(drinks_num = case_when(
    drinks == "0" ~ 0,
    drinks == "1-3" ~ 2,
    drinks == "3-5" ~ 4,
    drinks == "5-8" ~ 6.5,
    drinks == "8+" ~ 10,
    TRUE ~ NA_real_
  )) %>%
  filter(!is.na(faculty), !is.na(drinks_num))

kw_test <- kruskal.test(drinks_num ~ faculty, data = dane_fac)

dane_fac %>%
  group_by(faculty) %>%
  summarise(srednia_drinkow = mean(drinks_num), n = n()) %>%
  filter(n > 2) %>% 
  ggplot(aes(x = reorder(faculty, srednia_drinkow), y = srednia_drinkow, fill = srednia_drinkow)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_viridis_c(option = "mako", direction = -1) +
  labs(subtitle = paste("Test Kruskala-Wallisa p-value:", round(kw_test$p.value, 4)),
       x = "", y = "Åšrednia liczba drinkÃ³w (indeks)") +
  theme_minimal() +
  theme(legend.position = "none")
```

Wykres przedstawia Å›rednie spoÅ¼ycie alkoholu (liczbÄ™ drinkÃ³w) w zaleÅ¼noÅ›ci od wydziaÅ‚u.

### Interpretacja wynikÃ³w i wnioski
* NajwyÅ¼sze Å›rednie spoÅ¼ycie alkoholu wystÄ™puje na wydziaÅ‚ach **nauk rolniczych**, **prawa** oraz **zarzÄ…dzania i ekonomii**.
* NajniÅ¼sze Å›rednie spoÅ¼ycie alkoholu obserwowane jest natomiast na wydziaÅ‚ach **edukacji**, **medycyny** i **nauk Å›cisÅ‚ych**.
* RÃ³Å¼nice miÄ™dzy wydziaÅ‚ami sÄ… widoczne wizualnie (ok. 4-6,5 w skali indeksu), jednak nie sÄ… one bardzo duÅ¼e. Przeprowadzony **test Kruskala-Wallisa** wykazaÅ‚ wartoÅ›Ä‡ p-value = 0,1213 > 0,05, ktÃ³ra Å›wiadczy o **braku istotnych statystycznie rÃ³Å¼nic** w poziomie spoÅ¼ycia alkoholu pomiÄ™dzy wydziaÅ‚ami. Oznacza to, Å¼e zaobserwowane rÃ³Å¼nice w Å›rednich wartoÅ›ciach mogÄ… wynikaÄ‡ z losowych wahaÅ„ w prÃ³bie, a nie z rzeczywistych rÃ³Å¼nic miÄ™dzy populacjami studentÃ³w poszczegÃ³lnych wydziaÅ‚Ã³w.

>**Wniosek**: ChoÄ‡ studenci niektÃ³rych wydziaÅ‚Ã³w (np. nauk rolniczych i prawa) deklarujÄ… wyÅ¼sze Å›rednie spoÅ¼ycie alkoholu niÅ¼ studenci wydziaÅ‚Ã³w takich jak nauki Å›cisÅ‚e czy medycyna, rÃ³Å¼nice te **nie sÄ… istotne statystycznie**. Test Kruskalaâ€“Wallisa nie potwierdziÅ‚ istnienia istotnych rÃ³Å¼nic w poziomie spoÅ¼ycia alkoholu pomiÄ™dzy wydziaÅ‚ami.

## PorÃ³wnanie GPA wzglÄ™dem czasu poÅ›wiÄ™conego na naukÄ™

```{r porÃ³wnanie czy warto sie uczyc, echo=FALSE, fig.align='center'}
dane_nauka <- dane %>%
  mutate(GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y)) %>%
  filter(!is.na(studying), !is.na(GPA)) %>%
  mutate(study_group = case_when(
    studying %in% c("0", "1-3", "3-5") ~ "Do 5h / tydz.",
    studying %in% c("5-8", "8+") ~ "PowyÅ¼ej 5h / tydz.",
    TRUE ~ NA_character_
  )) %>%
  mutate(study_group = as.factor(study_group))

ggbetweenstats(
  data  = dane_nauka,
  x     = study_group,
  y     = GPA,
  type  = "robust", 
  tr    = 0.1,      
subtitle = "PodziaÅ‚ na progu 5 godzin dodatkowej pracy tygodniowo",
  xlab  = "IntensywnoÅ›Ä‡ nauki wÅ‚asnej",
  ylab  = "Åšrednia ocen (GPA %)",
  palette = "Set2", 
  package = "RColorBrewer",
  messages = FALSE)
```

Wykres przedstawia porÃ³wnanie wynikÃ³w GPA studentÃ³w w zaleÅ¼noÅ›ci od czasu poÅ›wiÄ™canego na naukÄ™ wÅ‚asnÄ…: grupa 1 to do 5 godzin tygodniowo (n = 206), natomiat grupa 2: powyÅ¼ej 5 godzin tygodniowo (n = 192).

### Interpretacje wynikÃ³w i wnioski
* **Åšrednie (trimmed mean) GPA** w obu grupach sÄ… niemal identyczne (grupa 1: 68,42; grupa 2: 67,90).
* **RozkÅ‚ady wynikÃ³w GPA** w obu grupach sÄ… bardzo podobne; zbliÅ¼one mediany, podobny zakres wartoÅ›ci oraz nie wykazujÄ… wyraÅºnego przesuniÄ™cia jednej grupy wzglÄ™dem drugiej.
* Przeprowadzony **test t Yuen'a** (odporny na obserwacje odstajÄ…ce) zwrÃ³ciÅ‚ wartoÅ›Ä‡ p-value = 0,63 > 0,05, zatem nie stwierdzono istotnej statystycznie rÃ³Å¼nicy w GPA pomiÄ™dzy studentami uczÄ…cymi siÄ™ do 5 godzin tygodniowo a tymi, ktÃ³rzy uczÄ… siÄ™ wiÄ™cej. PrzedziaÅ‚ ufnoÅ›ci obejmuje 0, co dodatkowo potwierdza brak istotnego efektu.

>**Wniosek**: Czas poÅ›wiÄ™cony na naukÄ™ wÅ‚asnÄ… (powyÅ¼ej lub poniÅ¼ej 5 godzin tygodniowo) **nie rÃ³Å¼nicuje istotnie** wynikÃ³w GPA. Studenci uczÄ…cy siÄ™ wiÄ™cej niÅ¼ 5 godzin tygodniowo nie osiÄ…gajÄ… statystycznie istotnie wyÅ¼szych wynikÃ³w niÅ¼ studenci uczÄ…cy siÄ™ krÃ³cej.

## WpÅ‚yw intensywnoÅ›ci nauki i imprezowania na Å›redniÄ… ocen (GPA)

```{r czy nauka osÅ‚abia negatywny wpÅ‚yw imprezowania, echo=FALSE, fig.align='center'}
dane_int <- dane %>%
  mutate(GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y)) %>%
  filter(!is.na(partying), !is.na(studying), !is.na(GPA)) %>%
  mutate(study_level = ifelse(studying %in% c("0", "1-3", "3-5"), "MaÅ‚o nauki (<5h)", "DuÅ¼o nauki (>5h)")) %>%
  mutate(party_level = case_when(
    partying == "0" ~ "Nigdy",
    partying %in% c("1", "Only weekends") ~ "Rzadko",
    partying %in% c("2", "3", "4+") ~ "CzÄ™sto",
    TRUE ~ NA_character_
  )) %>%
  mutate(party_level = factor(party_level, levels = c("Nigdy", "Rzadko", "CzÄ™sto")))

interakcja_summary <- dane_int %>%
  group_by(party_level, study_level) %>%
  summarise(mean_GPA = mean(GPA, na.rm = TRUE), .groups = 'drop')

ggplot(interakcja_summary, aes(x = party_level, y = mean_GPA, color = study_level, group = study_level)) +
  geom_line(size = 1.2) +
  geom_point(size = 4) +
  scale_color_manual(values = c("MaÅ‚o nauki (<5h)" = "#e74c3c", "DuÅ¼o nauki (>5h)" = "#2ecc71")) +
  labs(
    x = "IntensywnoÅ›Ä‡ imprezowania",
    y = "Åšrednia ocen (GPA %)",
    color = "Poziom nauki:"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

Wykres przedstawia interakcjÄ™ miÄ™dzy intensywnoÅ›ciÄ… nauki a czÄ™stotliwoÅ›ciÄ… imprezowania w odniesieniu do Å›redniego GPA. Zastosowana czÄ™stotliwoÅ›Ä‡ imprezowania ksztaÅ‚tuje siÄ™ nastÄ™pujÄ…co (w ujÄ™ciu tygodniowym): 0 imprez = Nigdy, 1 impreza lub wyÅ‚Ä…cznie w weekendy = Rzadko, 2+ imprez = CzÄ™sto.

### Interpretacja wynikÃ³w i wnioski
* Przy **braku imprezowania** intensywnoÅ›Ä‡ nauki wyraÅºnie rÃ³Å¼nicuje wyniki. MiÄ™dzy grupÄ… uczÄ…cÄ… siÄ™ poniÅ¼ej 5 godzin tygodniowo a tÄ… powyÅ¼ej 5 godzin wystÄ™puje przewaga GPA rzÄ™du 10 p.p. na korzyÅ›Ä‡ tych uczÄ…cych siÄ™ wiÄ™cej.
* W grupie **rzadko imprezujÄ…cej** dochodzi do ciekawego odwrÃ³cenia â€“ osoby uczÄ…ce siÄ™ mniej (linia czerwona) osiÄ…gajÄ… wyÅ¼sze wyniki niÅ¼ te uczÄ…ce siÄ™ duÅ¼o (linia zielona).
* Przy *duÅ¼ej czÄ™stotliwoÅ›ci imprez* sytuacja wraca do "normy", gdzie wiÄ™kszy nakÅ‚ad nauki przekÅ‚ada siÄ™ na nieco wyÅ¼sze oceny, choÄ‡ rÃ³Å¼nica jest znacznie mniejsza niÅ¼ w grupie nieimprezujÄ…cej (2 p.p.).

>**Wniosek**: Intensywne imprezowanie niweluje korzyÅ›ci pÅ‚ynÄ…ce z duÅ¼ej iloÅ›ci nauki. NajwyÅ¼sze wyniki osiÄ…gajÄ… studenci, ktÃ³rzy duÅ¼o siÄ™ uczÄ… i caÅ‚kowicie rezygnujÄ… z imprez. Co ciekawe, przy umiarkowanym (rzadkim) imprezowaniu, osoby poÅ›wiÄ™cajÄ…ce mniej czasu na naukÄ™ radzÄ… sobie lepiej od tych, ktÃ³re uczÄ… siÄ™ duÅ¼o, co moÅ¼e sugerowaÄ‡ wystÄ™powanie innych czynnikÃ³w (np. efektywnoÅ›Ä‡ nauki, balans Å¼ycie-studia).

## Szacowany wpÅ‚yw czasu nauki i wydziaÅ‚u na wynik GPA

```{r wykres ancova, echo=FALSE}
dane_ancova <- dane %>%
  mutate(
    GPA = ifelse(is.na(grade_last_y), grade_12, grade_last_y),
    study_num = case_when(
      studying == "0" ~ 0,
      studying == "1-3" ~ 1.5,
      studying == "3-5" ~ 4,
      studying == "5-8" ~ 6.5,
      studying == "8+" ~ 10,
      TRUE ~ NA_real_
    ),
    faculty = as.factor(faculty) 
  ) %>%
  filter(!is.na(faculty), !is.na(GPA), !is.na(study_num)) %>%
  group_by(faculty) %>%
  filter(n() >= 5) %>%
  ungroup()

model_ancova <- lm(GPA ~ study_num + faculty, data = dane_ancova)

tabela_dane <- Anova(model_ancova, type = "III") %>%
  tidy() %>%
  filter(!is.na(p.value)) %>% 
  filter(term != "(Intercept)") %>%
  mutate(
    `WartoÅ›Ä‡ p` = cell_spec(
      scales::pvalue(p.value, accuracy = 0.001), 
      bold = ifelse(p.value < 0.05, TRUE, FALSE),
      color = ifelse(p.value < 0.05, "red", "black")
    ),
    statistic = round(statistic, 2),
    sumsq = round(sumsq, 1)
  ) %>%
  rename(
    `Czynnik` = term, 
    `Suma kwadratÃ³w` = sumsq, 
    `df` = df,
    `Statystyka F` = statistic)

plot_model(model_ancova, 
           type = "est", 
           show.values = TRUE, 
           value.offset = .3,
           title = "WpÅ‚yw czynnikÃ³w na wynik GPA",
           axis.labels = NULL, 
           vline.color = "grey50",
           dot.size = 3.5,
           line.size = 1.2,
           colors = "Dark2") +
  theme_minimal(base_size = 12) +
  theme(
    panel.grid.minor = element_blank(),
    plot.title = element_text(face = "bold"),
    axis.text.y = element_text(size = 10, face = "bold")
  ) +
  labs(
    subtitle = "WspÃ³Å‚czynniki regresji z 95% przedziaÅ‚em ufnoÅ›ci.",
    y = "Szacowana zmiana GPA (%)",
    x = "")
```

Wykres przedstawia wyniki modelu regresji ilustrujÄ…cego wpÅ‚yw liczby godzin nauki oraz przynaleÅ¼noÅ›ci do wydziaÅ‚u na poziom GPA wraz z 95% przedziaÅ‚ami ufnoÅ›ci.

### Interpretacja wynikÃ³w i wnioski
* Zmienna liczba godzin nauki (study num) **nie wykazuje istotnego wpÅ‚ywu** na wynik GPA; oszacowany wspÃ³Å‚czynnik jest bliski zeru, a przedziaÅ‚ ufnoÅ›ci obejmuje wartoÅ›Ä‡ 0, co wskazuje na brak statystycznie istotnej zaleÅ¼noÅ›ci miÄ™dzy czasem nauki a osiÄ…gniÄ™ciami akademickimi.
* PrzynaleÅ¼noÅ›Ä‡ do wydziaÅ‚u **rÃ³Å¼nicuje poziom GPA**: Studenci wydziaÅ‚Ã³w Medicine and Health Services, Engineering oraz Education osiÄ…gajÄ… przeciÄ™tnie wyÅ¼sze wyniki GPA w porÃ³wnaniu z grupÄ… referencyjnÄ…, natomiast studenci wydziaÅ‚Ã³w AgriSciences, Economic & Management Sciences oraz Law uzyskujÄ… przeciÄ™tnie niÅ¼sze wartoÅ›ci GPA.
* Najsilniejszy ujemny efekt obserwuje siÄ™ dla wydziaÅ‚u **AgriSciences**, natomiast najwyÅ¼szy dodatni efekt dla kierunkÃ³w zwiÄ…zanych z **medycynÄ… i ochronÄ… zdrowia**.
* SzerokoÅ›Ä‡ przedziaÅ‚Ã³w ufnoÅ›ci dla czÄ™Å›ci wydziaÅ‚Ã³w wskazuje na wiÄ™kszÄ… niepewnoÅ›Ä‡ estymacji, co sugeruje ostroÅ¼noÅ›Ä‡ w interpretacji siÅ‚y poszczegÃ³lnych efektÃ³w.

>**Wniosek**: Wyniki modelu regresji wskazujÄ…, Å¼e przynaleÅ¼noÅ›Ä‡ do wydziaÅ‚u ma istotniejsze znaczenie dla poziomu GPA niÅ¼ sama liczba godzin poÅ›wiÄ™canych na naukÄ™. NajwyÅ¼sze wartoÅ›ci GPA obserwuje siÄ™ wÅ›rÃ³d studentÃ³w kierunkÃ³w medycznych i inÅ¼ynierskich, natomiast najniÅ¼sze wÅ›rÃ³d studentÃ³w nauk rolniczych oraz ekonomiczno-zarzÄ…dczych. Czas nauki, analizowany samodzielnie, nie stanowi istotnego predyktora wynikÃ³w akademickich.

```{r tabela ancova, echo=FALSE}
tabela_dane %>%
  kable(
    format = "html", 
    escape = FALSE, 
    align = "c",
    caption = "Wyniki analizy kowariancji (ANCOVA)"
  ) %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") 
```

PowyÅ¼sza analiza zostaÅ‚a dodatkowo poparta **analizÄ… kowariancji (ANCOVA)**, w ktÃ³rej zbadano wpÅ‚yw liczby godzin nauki (study_num) oraz wydziaÅ‚u (faculty) na poziom GPA, przy jednoczesnym uwzglÄ™dnieniu ob czynnikÃ³w w jednym modelu. Analiza ta **nie potwierdziÅ‚a istotnego wpÅ‚ywu** czasu nauki ani wydziaÅ‚u na poziom GPA, co sugeruje, Å¼e obserwowane wczeÅ›niej rÃ³Å¼nice majÄ… charakter opisowy i nie znajdujÄ… potwierdzenia statystycznego w modelu.

# UporzÄ…dkowany model logitowy

```{r model logitowy do pytania 6, echo=FALSE, message=FALSE, warning=FALSE}
dane_ordinal <- dane %>%
  mutate(
    fail_level = case_when(
      modules_failed == "0" ~ "Brak",
      modules_failed == "1" ~ "1 oblany",
      modules_failed == "2" ~ "2 oblane",
      modules_failed %in% c("3", "4+") ~ "3+ oblane"
    ),
    fail_level = factor(fail_level, 
                        levels = c("Brak", "1 oblany", "2 oblane", "3+ oblane"), 
                        ordered = TRUE),
    party_num = case_when(
      partying == "0" ~ 0,
      partying == "1" ~ 1,
      partying == "Only weekends" ~ 1.5,
      partying %in% c("2", "3", "4+") ~ 3,
      TRUE ~ NA_real_
    ),
    missed_num = case_when(
      classes_missed == "0" ~ 0,
      classes_missed == "1" ~ 1,
      classes_missed == "2" ~ 2,
      classes_missed %in% c("3", "4+") ~ 3,
      TRUE ~ NA_real_
    )
  ) %>%
  filter(!is.na(fail_level), !is.na(party_num), !is.na(missed_num))

model_ord_simple <- polr(fail_level ~ party_num + missed_num, 
                         data = dane_ordinal, 
                         Hess = TRUE)

wyniki_statystyczne <- tidy(model_ord_simple, exponentiate = TRUE, conf.int = TRUE) %>%
  filter(coef.type == "coefficient") %>%
  mutate(
    p.value = 2 * pnorm(abs(statistic), lower.tail = FALSE),
    term = case_when(
      term == "party_num" ~ "CzÄ™stotliwoÅ›Ä‡ imprezowania",
      term == "missed_num" ~ "Opuszczanie zajÄ™Ä‡",
      TRUE ~ term
    ),
    label_text = paste0("OR: ", round(estimate, 2))
  )
```

```{r model logitowy wykres, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(wyniki_statystyczne, aes(x = reorder(term, estimate), y = estimate)) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "grey60", size = 0.8) +
  geom_segment(aes(x = term, xend = term, y = 1, yend = estimate), 
               color = ifelse(wyniki_statystyczne$p.value < 0.05, "#2980b9", "grey80"), 
               size = 1.2) +
  geom_point(aes(color = p.value < 0.05), size = 5) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), 
                width = 0.1, color = "grey40", alpha = 0.6) +
  geom_text(aes(label = label_text), hjust = -0.4, vjust = -0.5, size = 3.5, fontface = "bold", color = "#34495e") +
  coord_flip() +
  scale_color_manual(values = c("TRUE" = "#2980b9", "FALSE" = "grey80")) +
  labs(
    title = "Co zwiÄ™ksza liczbÄ™ oblanych przedmiotÃ³w:",
    x = "",
    y = "Iloraz Szans"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    panel.grid.major.y = element_blank(),
    plot.title = element_text(face = "bold", size = 16, color = "#2c3e50"),
    axis.text.y = element_text(face = "bold", size = 11)
  )
```

```{r model logitowy tabela, echo=FALSE, message=FALSE, warning=FALSE}
wyniki_statystyczne %>%
  mutate(
    p_val_num = scales::pvalue(p.value, accuracy = 0.001),
    estimate = round(estimate, 2),
    conf.low = round(conf.low, 2),
    conf.high = round(conf.high, 2)
  ) %>%
  dplyr::select(
    `Czynnik` = term,
    `OR` = estimate,
    `Dolna gr.` = conf.low,
    `GÃ³rna gr.` = conf.high,
    `p-value` = p_val_num
  ) %>%
  kable(
    format = "html", 
    align = "lcccc",
    caption = "Wyniki porzÄ…dkowego modelu logitowego"
  ) %>%
  kable_material(c("striped", "hover"), full_width = F, html_font = "Roboto") %>%
  column_spec(2, bold = TRUE, background = "#eaf2f8", color = "#2874a6", border_right = TRUE) %>%
  column_spec(5, color = "grey40", italic = TRUE) %>%
  row_spec(0, background = "#2c3e50", color = "white", bold = TRUE)
```

## Metodologia
Zastosowana metoda: **Regresja Logistyczna dla Zmiennych PorzÄ…dkowych**.

W celu zbadania czynnikÃ³w wpÅ‚ywajÄ…cych na skalÄ™ niepowodzeÅ„ akademickich, zastosowano model proporcjonalnych szans. Jest to specyficzny rodzaj regresji, dedykowany do analizy zmiennych, ktÃ³re posiadajÄ… naturalny porzÄ…dek, ale nie sÄ… liczbami ciÄ…gÅ‚ymi. Zastosowano nastÄ™pujÄ…ce uporzÄ…dkowanie: Brak niezdanych przedmiotÃ³w < 1 niezdany < 2 niezdane < 3 niezdane.

## Interpretacje i wnioski
**Opuszczanie zajÄ™Ä‡**: Zmienna ta jest istotnym statystycznie czynnikiem ryzyka. KaÅ¼dy wzrost czÄ™stotliwoÅ›ci opuszczania zajÄ™Ä‡ o jeden poziom wiÄ…Å¼e siÄ™ ze wzrostem szansy na gorszy wynik egzaminacyjny (tj. oblanie wiÄ™kszej liczby przedmiotÃ³w) o 23%.

**CzÄ™stotliwoÅ›Ä‡ imprezowania**: Wynik ten jest wysoce istotny i wskazuje na silnÄ…, odwrotnÄ… zaleÅ¼noÅ›Ä‡. WartoÅ›Ä‡ OR poniÅ¼ej 1.0 oznacza, Å¼e wyÅ¼sza aktywnoÅ›Ä‡ towarzyska (przy staÅ‚ym poziomie nieobecnoÅ›ci) wiÄ…Å¼e siÄ™ ze spadkiem ryzyka poraÅ¼ki. Konkretnie, wyÅ¼szy poziom aktywnoÅ›ci towarzyskiej obniÅ¼a szansÄ™ na niepowodzenie o okoÅ‚o 31%.

>**Wniosek**: Wynik ten sugeruje, Å¼e Å¼ycie towarzyskie moÅ¼e peÅ‚niÄ‡ funkcjÄ™ "bufora stresu" lub sprzyjaÄ‡ budowaniu kapitaÅ‚u spoÅ‚ecznego (wspÃ³lna nauka, wymiana notatek). Studenci aktywni towarzysko radzÄ… sobie lepiej niÅ¼ osoby izolujÄ…ce siÄ™, pod warunkiem, Å¼e imprezowanie nie prowadzi do opuszczania zajÄ™Ä‡.

# Podsumowanie

Analiza zostaÅ‚a oparta na **szerokim sondaÅ¼u studenckim** obejmujÄ…cym dane demograficzne, ekonomiczne i behawioralne oraz informacje o **GPA** i **spoÅ¼yciu alkoholu**. 


#### Przygotowanie danych i metodologia
Dane zostaÅ‚y wczeÅ›niej uporzÄ…dkowane: usuniÄ™to obserwacje bez kluczowych zmiennych (pÅ‚eÄ‡, wydziaÅ‚, rok studiÃ³w), sprawdzono wartoÅ›ci skrajne oraz uzupeÅ‚niono braki metodÄ… **k-Nearest Neighbors** ($k = 5$), z dodatkowymi korektami dla wybranych grup, np. studentÃ³w pierwszego roku. 

> JakoÅ›Ä‡ imputacji byÅ‚a **kontrolowana wizualnie i statystycznie**, aby ograniczyÄ‡ ryzyko znieksztaÅ‚ceÅ„ wynikÃ³w.


#### Wyniki opisowe i charakterystyka prÃ³by
Wyniki opisowe pokazaÅ‚y silne zrÃ³Å¼nicowanie wzorcÃ³w picia:

* **IntensywnoÅ›Ä‡ spoÅ¼ycia:** OkoÅ‚o **poÅ‚owa badanych** deklarowaÅ‚a intensywne spoÅ¼ycie alkoholu w kategoriach `5â€“8` i `8+`.
* **Abstynenci:** Stanowili jedynie okoÅ‚o **7%** prÃ³by.
* **RozkÅ‚ad GPA:** ZbliÅ¼ony do normalnego:
    * Åšrednia: $\approx 68,4\%$
    * Mediana: $\approx 68\%$
    * Odchylenie standardowe: $\approx 9,98$

PozwalaÅ‚o to traktowaÄ‡ tÄ™ zmiennÄ… jako **stabilny punkt odniesienia** w dalszych analizach.


#### ZaleÅ¼noÅ›Ä‡ alkohol a wyniki akademickie
ZaleÅ¼noÅ›Ä‡ ta okazaÅ‚a siÄ™ **statystycznie istotna, ale bardzo sÅ‚aba**:

* WspÃ³Å‚czynnik Spearmana: $\rho = -0,086$ ($p < 0,001$).
* WyjaÅ›nienie zmiennoÅ›ci: Alkohol wyjaÅ›nia **mniej niÅ¼ 1%** zmiennoÅ›ci GPA. 

Wynik ten sugeruje, Å¼e samo picie nie jest gÅ‚Ã³wnym czynnikiem decydujÄ…cym o sukcesie akademickim, a jego negatywne skutki ujawniajÄ… siÄ™ gÅ‚Ã³wnie w **przypadkach skrajnych** lub sÄ… czÄ™Å›ciowo rÃ³wnowaÅ¼one przez inne zachowania, takie jak intensywniejsza nauka w tygodniach bez imprez.


#### Rola czynnikÃ³w kontekstowych
IstotnÄ… rolÄ™ odegraÅ‚y czynniki kontekstowe:

* **BudÅ¼et:** Studenci o wyÅ¼szym budÅ¼ecie czÄ™Å›ciej prowadzili intensywne Å¼ycie towarzyskie, co poÅ›rednio zwiÄ™kszaÅ‚o ryzyko gorszych wynikÃ³w.
* **Miejsce zamieszkania:** 
* W **akademikach** przy bardzo wysokim spoÅ¼yciu odsetek osÃ³b opuszczajÄ…cych co najmniej dwa zajÄ™cia siÄ™gaÅ‚ okoÅ‚o **70%**.
* W **mieszkaniach prywatnych** wynosiÅ‚ okoÅ‚o **47%**.
* **Model logitowy:** PotwierdziÅ‚, Å¼e zarÃ³wno intensywnoÅ›Ä‡ picia, jak i Å›rodowisko mieszkaniowe istotnie zwiÄ™kszajÄ… prawdopodobieÅ„stwo absencji.


#### Mechanizmy kompensacji i uwarunkowania spoÅ‚eczne
Analiza pokazaÅ‚a, Å¼e wiÄ™kszy nakÅ‚ad pracy wÅ‚asnej wiÄ…Å¼e siÄ™ z wyÅ¼szym GPA, jednak tylko do pewnego poziomu. 

* **Kompensacja:** Dodatkowe godziny nauki mogÄ… czÄ™Å›ciowo neutralizowaÄ‡ skutki umiarkowanego imprezowania, ale przy bardzo intensywnym stylu Å¼ycia efekt ten sÅ‚abnie. 
* **PÅ‚eÄ‡:** Nie okazaÅ‚a siÄ™ istotnym moderatorem zaleÅ¼noÅ›ci.
* **Aprobata rodzicÃ³w:** Istotnie zwiÄ…zana z wyÅ¼szÄ… konsumpcjÄ… ($\chi^2 = 16,06$; $p = 0,003$). 
* **Stypendia:** Pobieranie stypendium sprzyjaÅ‚o wiÄ™kszej dyscyplinie i stabilniejszym wynikom.


#### Ograniczenia i wnioski praktyczne
Badanie ma swoje ograniczenia: dane sÄ… **samoopisowe i obserwacyjne**, dlatego nie pozwalajÄ… jednoznacznie rozstrzygaÄ‡ o przyczynach i skutkach. Mimo starannej imputacji pozostaje pewien poziom niepewnoÅ›ci.

> **Rekomendacje:**
Z praktycznego punktu widzenia wyniki sugerujÄ…, Å¼e uczelnie powinny traktowaÄ‡ problem spoÅ¼ycia alkoholu nie tylko jako kwestiÄ™ zdrowia, ale takÅ¼e jako element wpÅ‚ywajÄ…cy poÅ›rednio na **funkcjonowanie akademickie**. 

Najbardziej sensowne wydajÄ… siÄ™ dziaÅ‚ania kierowane do konkretnych grup ryzyka, zwÅ‚aszcza mieszkaÅ„cÃ³w **akademikÃ³w** oraz studentÃ³w o **wysokim budÅ¼ecie**. CaÅ‚oÅ›Ä‡ pokazuje, Å¼e wpÅ‚yw alkoholu na GPA jest niewielki, ale jego znaczenie roÅ›nie w okreÅ›lonych kontekstach spoÅ‚ecznych i przy bardzo intensywnych wzorcach konsumpcji.